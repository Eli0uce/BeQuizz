<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multi-Gaming Quiz Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Beaufort:wght@400;700&family=Spiegel:wght@400;700&display=swap" rel="stylesheet" />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Roboto:wght@400;500;900&family=Press+Start+2P&family=Oswald:wght@700&family=Luckiest+Guy&family=Rye&display=swap");

      :root {
        /* Variables par d√©faut */
        --primary-color: #c8aa6e;
        --secondary-color: #0ac8b9;
        --bg-start: #091428;
        --bg-end: #010a13;
        --text-main: #f0e6d2;
        --border-color: #3c3c41;
        --font-main: "Roboto", sans-serif;
        --font-title: "Cinzel", serif;
      }

      body {
        font-family: var(--font-main);
        background-color: var(--bg-end);
        background-image: radial-gradient(circle at center, var(--bg-start) 0%, var(--bg-end) 100%);
        color: var(--text-main);
        overflow-x: hidden;
        transition: background 0.5s ease;
      }

      h1,
      h2,
      h3,
      .title-font {
        font-family: var(--font-title);
      }

      /* Classes dynamiques bas√©es sur les variables CSS */
      .theme-text-primary {
        color: var(--primary-color);
      }
      .theme-text-secondary {
        color: var(--secondary-color);
      }
      .theme-border {
        border-color: var(--primary-color);
      }
      .theme-bg-primary {
        background-color: var(--primary-color);
      }

      .theme-btn {
        background: rgba(0, 0, 0, 0.3);
        border: 2px solid var(--primary-color);
        color: var(--primary-color);
        position: relative;
        transition: all 0.3s ease;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        font-family: var(--font-title);
      }

      .theme-btn:hover {
        background: var(--primary-color);
        color: #000;
        box-shadow: 0 0 20px var(--primary-color);
        transform: translateY(-2px);
      }

      .theme-btn.disabled-btn {
        pointer-events: none;
        opacity: 0.5;
      }

      /* Cards pour la s√©lection de jeu */
      .game-card {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
        cursor: pointer;
        overflow: hidden;
      }
      .game-card:hover {
        transform: translateY(-5px) scale(1.02);
        border-color: var(--hover-color, #fff);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      }

      /* Animations */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .fade-in {
        animation: fadeIn 0.5s ease-out forwards;
      }

      /* Utilitaires Quiz */
      .correct-answer {
        background: rgba(0, 255, 0, 0.2) !important;
        border-color: #00ff00 !important;
        color: #00ff00 !important;
      }
      .wrong-answer {
        background: rgba(255, 0, 0, 0.2) !important;
        border-color: #ff0000 !important;
        color: #ff0000 !important;
      }

      /* D√©corations sp√©cifiques */
      .decorative-frame {
        position: relative;
      }
      .decorative-frame::before {
        content: "";
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        border: 1px solid var(--primary-color);
        z-index: -1;
        opacity: 0.5;
        transition: border-color 0.5s ease;
      }

      /* Difficult√©s */
      .difficulty-card:hover {
        filter: brightness(1.2);
        transform: scale(1.05);
      }

      /* SYST√àME DE PROGRESSION */
      .xp-bar-container {
        background: rgba(255, 255, 255, 0.1);
        height: 12px;
        border-radius: 6px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .xp-bar-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary-color), #fff);
        width: 0%;
        transition: width 1s ease-in-out;
        box-shadow: 0 0 10px var(--primary-color);
      }

      .lock-overlay {
        position: absolute;
        inset: 0;
        background: rgba(0, 0, 0, 0.85);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 20;
        opacity: 0;
        transition: opacity 0.3s ease;
        pointer-events: none;
      }

      .game-card.locked:hover .lock-overlay {
        opacity: 1;
      }

      .game-card.locked {
        cursor: not-allowed;
        filter: grayscale(0.8);
      }

      .badge-card {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 1rem;
        border-radius: 0.5rem;
        text-align: center;
        transition: all 0.3s ease;
      }

      .badge-card.locked {
        filter: grayscale(1) blur(1px);
        opacity: 0.5;
      }

      .badge-card i {
        font-size: 2rem;
        margin-bottom: 0.5rem;
      }

      /* XP NOTIFICATION */
      #xp-notification {
        position: fixed;
        bottom: -100px;
        right: 2rem;
        background: rgba(0, 0, 0, 0.9);
        border: 2px solid var(--primary-color);
        padding: 1rem 2rem;
        border-radius: 1rem;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        align-items: center;
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }

      #xp-notification.show {
        bottom: 2rem;
      }

      .level-up-banner {
        color: #ffd700;
        font-weight: bold;
        text-transform: uppercase;
        animation: pulseGold 1.5s infinite;
      }

      @keyframes pulseGold {
        0%, 100% { text-shadow: 0 0 10px #ffd700; transform: scale(1); }
        50% { text-shadow: 0 0 25px #ffd700; transform: scale(1.1); }
      }

      /* Auth Tabs */
      .auth-tab {
        padding: 0.75rem 1.5rem;
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all 0.3s;
        color: #666;
      }

      .auth-tab.active {
        border-color: var(--primary-color);
        color: var(--primary-color);
      }

      .profile-btn {
        position: absolute;
        top: 1.5rem;
        right: 1.5rem;
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.5);
        border: 2px solid var(--primary-color);
        color: var(--primary-color);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 50;
        transition: all 0.3s;
      }

      .profile-btn:hover {
        background: var(--primary-color);
        color: #000;
        box-shadow: 0 0 15px var(--primary-color);
      }
    </style>
  </head>
  <body class="min-h-screen flex items-center justify-center p-4">
    <!-- Container Principal -->
    <div id="main-container" class="w-full max-w-7xl bg-black/80 backdrop-blur-md border border-gray-700 p-1 decorative-frame shadow-2xl relative fade-in rounded-xl">
      <!-- Bouton Profil (persistant) -->
      <div id="top-profile-btn" onclick="showProfile()" class="profile-btn hidden">
        <i class="fas fa-user"></i>
      </div>

      <div class="p-6 md:p-10 text-center relative z-10">
        <!-- √âCRAN AUTHENTIFICATION -->
        <div id="auth-screen">
          <div class="max-w-md mx-auto">
            <h1 class="text-4xl font-bold mb-8 theme-text-primary" style="font-family: 'Oswald', sans-serif">BIENVENUE</h1>
            
            <div class="flex mb-6 border-b border-gray-800">
              <div id="tab-login" onclick="switchAuthTab('login')" class="auth-tab active flex-1 font-bold">CONNEXION</div>
              <div id="tab-signup" onclick="switchAuthTab('signup')" class="auth-tab flex-1 font-bold">INSCRIPTION</div>
            </div>

            <!-- Login Form -->
            <div id="login-form" class="space-y-4">
              <input type="text" id="login-username" placeholder="Nom d'utilisateur" class="w-full bg-black/50 border border-gray-700 p-3 rounded focus:border-primary-color outline-none text-white">
              <input type="password" id="login-password" placeholder="Mot de passe" class="w-full bg-black/50 border border-gray-700 p-3 rounded focus:border-primary-color outline-none text-white">
              <button onclick="handleLogin()" class="theme-btn w-full py-3 rounded font-bold mt-4">SE CONNECTER</button>
            </div>

            <!-- Signup Form -->
            <div id="signup-form" class="space-y-4 hidden">
              <input type="text" id="signup-username" placeholder="Choisir un pseudo" class="w-full bg-black/50 border border-gray-700 p-3 rounded focus:border-primary-color outline-none text-white">
              <input type="password" id="signup-password" placeholder="Choisir un mot de passe" class="w-full bg-black/50 border border-gray-700 p-3 rounded focus:border-primary-color outline-none text-white">
              <button onclick="handleSignup()" class="theme-btn w-full py-3 rounded font-bold mt-4">CR√âER UN COMPTE</button>
            </div>
            
            <p id="auth-error" class="text-red-500 mt-4 text-sm hidden"></p>
          </div>
        </div>

        <!-- √âCRAN PROFIL -->
        <div id="profile-screen" class="hidden">
          <button onclick="goHome()" class="absolute top-0 left-0 text-gray-500 hover:text-white transition-colors"><i class="fas fa-arrow-left"></i> Retour</button>
          
          <div class="flex flex-col md:flex-row gap-8 items-start">
            <!-- Sidebar Profil -->
            <div class="w-full md:w-1/3 bg-black/40 p-6 rounded-lg border border-gray-800">
              <div id="profile-avatar" class="w-24 h-24 rounded-full mx-auto mb-4 flex items-center justify-center text-4xl border-4 border-primary-color bg-gray-900">
                <i class="fas fa-user"></i>
              </div>
              <h2 id="profile-username" class="text-2xl font-bold theme-text-primary mb-1">Username</h2>
              <div id="profile-level-badge" class="inline-block px-3 py-1 bg-primary-color text-black font-bold rounded-full text-sm mb-4">Lv. 1</div>
              
              <!-- Barre XP -->
              <div class="text-left mb-2 flex justify-between text-xs">
                <span>Progression XP</span>
                <span id="profile-xp-text">0 / 100 XP</span>
              </div>
              <div class="xp-bar-container mb-6">
                <div id="profile-xp-fill" class="xp-bar-fill"></div>
              </div>

              <div class="grid grid-cols-2 gap-2 mb-6">
                <div class="bg-black/40 p-3 rounded border border-gray-800">
                  <div class="text-xs text-gray-500 uppercase">Quizz jou√©s</div>
                  <div id="stats-quizzes" class="text-xl font-bold">0</div>
                </div>
                <div class="bg-black/40 p-3 rounded border border-gray-800">
                  <div class="text-xs text-gray-500 uppercase">Jeux d√©bloqu√©s</div>
                  <div id="stats-games" class="text-xl font-bold">3/12</div>
                </div>
              </div>

              <button onclick="showLeaderboard()" class="w-full py-2 mb-2 bg-white/10 hover:bg-white/20 rounded text-sm transition-colors"><i class="fas fa-trophy mr-2 theme-text-primary"></i> Voir le classement</button>
              <button onclick="resetProgress()" class="w-full py-2 mb-2 bg-yellow-900/20 hover:bg-yellow-900/40 text-yellow-500 rounded text-sm transition-colors"><i class="fas fa-redo mr-2"></i> R√©initialiser ma progression</button>
              <button onclick="deleteAccount()" class="w-full py-2 mb-2 bg-red-900/20 hover:bg-red-900/40 text-red-500 rounded text-sm transition-colors"><i class="fas fa-trash mr-2"></i> Supprimer mon compte</button>
              <button onclick="logout()" class="w-full py-2 bg-gray-900/50 hover:bg-gray-800 rounded text-sm transition-colors"><i class="fas fa-sign-out-alt mr-2 text-red-500"></i> D√©connexion</button>
            </div>

            <!-- Contenu Profil -->
            <div class="w-full md:w-2/3 space-y-8">
              <!-- Badges -->
              <div class="text-left">
                <h3 class="text-xl font-bold mb-4 flex items-center"><i class="fas fa-medal mr-2 theme-text-primary"></i> Badges & Succ√®s</h3>
                <div id="badges-grid" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3">
                  <!-- Badges inject√©s ici -->
                </div>
              </div>

              <!-- Meilleurs Scores -->
              <div class="text-left">
                <h3 class="text-xl font-bold mb-4 flex items-center"><i class="fas fa-star mr-2 theme-text-primary"></i> Meilleurs Records</h3>
                <div id="best-scores-grid" class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                  <!-- Scores inject√©s ici -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- √âCRAN CLASSEMENT -->
        <div id="leaderboard-screen" class="hidden">
          <button onclick="showProfile()" class="absolute top-0 left-0 text-gray-500 hover:text-white transition-colors"><i class="fas fa-arrow-left"></i> Retour</button>
          
          <h2 class="text-3xl font-bold mb-8 theme-text-primary" style="font-family: 'Oswald', sans-serif">CLASSEMENT MONDIAL</h2>
          
          <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse">
              <thead>
                <tr class="border-b border-gray-800 text-gray-500 text-sm uppercase">
                  <th class="py-4 px-4">Rang</th>
                  <th class="py-4 px-4">Utilisateur</th>
                  <th class="py-4 px-4 text-center">Niveau</th>
                  <th class="py-4 px-4 text-right">XP Totale</th>
                  <th class="py-4 px-4 text-right">Quizz</th>
                </tr>
              </thead>
              <tbody id="leaderboard-body">
                <!-- Lignes inject√©es ici -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- √âCRAN S√âLECTION DU JEU -->
        <div id="select-screen" class="hidden">
          <div class="mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-2" style="font-family: 'Oswald', sans-serif">GAMING QUIZ HUB</h1>
            <p class="text-gray-400">Choisissez votre univers</p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 mx-auto">
            <!-- Carte Minecraft -->
            <div id="game-minecraft" onclick="initGame('minecraft')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #8bc34a">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">1</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-green-800/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-cube text-4xl mb-4 text-[#8bc34a]"></i>
              <h3 class="text-lg font-bold text-[#8bc34a] mb-2" style="font-family: 'Press Start 2P', cursive; font-size: 0.7rem; line-height: 1.5rem">Minecraft</h3>
            </div>

            <!-- Carte Mario -->
            <div id="game-mario" onclick="initGame('mario')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #ff0000">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">1</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-blue-500/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-gamepad text-4xl mb-4 text-[#FF0000]"></i>
              <h3 class="text-lg font-bold text-[#FF0000] mb-2" style="font-family: 'Press Start 2P', cursive; font-size: 0.7rem; line-height: 1.5rem">Super Mario</h3>
            </div>

            <!-- Carte Pok√©mon -->
            <div id="game-pokemon" onclick="initGame('pokemon')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #ffcb05">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">1</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-red-600/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-bolt text-4xl mb-4 text-[#ffcb05]"></i>
              <h3 class="text-lg font-bold text-[#ffcb05] mb-2" style="font-family: 'Luckiest Guy', cursive">Pok√©mon</h3>
            </div>

            <!-- Carte Fortnite -->
            <div id="game-fortnite" onclick="initGame('fortnite')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #9d4dbb">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">2</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-blue-600/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-hammer text-4xl mb-4 text-[#9d4dbb]"></i>
              <h3 class="text-lg font-bold text-[#9d4dbb] mb-2" style="font-family: 'Luckiest Guy', cursive">Fortnite</h3>
            </div>

            <!-- Carte GTA -->
            <div id="game-gta" onclick="initGame('gta')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #4caf50">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">3</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-green-900/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-car text-4xl mb-4 text-[#4caf50]"></i>
              <h3 class="text-lg font-bold text-[#4caf50] mb-2" style="font-family: 'Oswald', sans-serif">Grand Theft Auto</h3>
            </div>

            <!-- Carte Valorant -->
            <div id="game-valorant" onclick="initGame('valorant')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #ff4655">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">4</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-red-900/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-crosshairs text-4xl mb-4 text-[#ff4655]"></i>
              <h3 class="text-lg font-bold text-[#ff4655] mb-2" style="font-family: 'Oswald', sans-serif">VALORANT</h3>
            </div>

            <!-- Carte League of Legends -->
            <div id="game-lol" onclick="initGame('lol')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #c8aa6e">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">5</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-blue-900/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-fist-raised text-4xl mb-4 text-[#C8AA6E]"></i>
              <h3 class="text-lg font-bold text-[#C8AA6E] mb-2 font-serif">League of Legends</h3>
            </div>

            <!-- Carte Zelda -->
            <div id="game-zelda" onclick="initGame('zelda')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #ffd700">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">6</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-green-900/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-triforce text-4xl mb-4 text-[#ffd700]"></i>
              <h3 class="text-lg font-bold text-[#ffd700] mb-2" style="font-family: 'Cinzel', serif">The Legend of Zelda</h3>
            </div>

            <!-- Carte Assassin's Creed -->
            <div id="game-ac" onclick="initGame('ac')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #a60000">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">7</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-gray-900/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-user-secret text-4xl mb-4 text-[#A60000]"></i>
              <h3 class="text-lg font-bold text-[#d4af37] mb-2" style="font-family: 'Cinzel', serif">Assassin's Creed</h3>
            </div>

            <!-- Carte Tekken -->
            <div id="game-tekken" onclick="initGame('tekken')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #ff3333">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">9</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-red-900/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-fire text-4xl mb-4 text-[#FF3333]"></i>
              <h3 class="text-lg font-bold text-[#FF3333] mb-2" style="font-family: 'Oswald', sans-serif">TEKKEN</h3>
            </div>

            <!-- Carte Ratchet -->
            <div id="game-ratchet" onclick="initGame('ratchet')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #f27200">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">11</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-blue-900/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-robot text-4xl mb-4 text-[#F27200]"></i>
              <h3 class="text-lg font-bold text-[#F27200] mb-2" style="font-family: 'Oswald', sans-serif">Ratchet: Gladiator</h3>
            </div>

            <!-- Carte God of War -->
            <div id="game-gow" onclick="initGame('gow')" class="game-card p-6 rounded-lg group relative" style="--hover-color: #d32f2f">
              <div class="lock-overlay">
                <i class="fas fa-lock text-3xl mb-2"></i>
                <span class="text-xs font-bold uppercase">Niveau <span class="req-lvl">13</span> requis</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-br from-red-800/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <i class="fas fa-skull text-4xl mb-4 text-[#d32f2f]"></i>
              <h3 class="text-lg font-bold text-[#d32f2f] mb-2" style="font-family: 'Cinzel', serif">God of War</h3>
            </div>
          </div>
        </div>

        <!-- √âCRAN S√âLECTION DIFFICULT√â -->
        <div id="difficulty-screen" class="hidden">
          <button onclick="goHome()" class="absolute top-0 left-0 text-gray-500 hover:text-white transition-colors"><i class="fas fa-arrow-left"></i> Retour</button>

          <div class="mb-8">
            <h2 id="diff-game-title" class="text-3xl font-bold theme-text-primary mb-2">JEU</h2>
            <p class="text-gray-400">Choisissez votre niveau de d√©fi</p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-2xl mx-auto">
            <button id="diff-easy" onclick="selectDifficulty('easy')" class="difficulty-card relative p-6 rounded-lg border border-green-500 bg-green-900/20 text-green-400 transition-all">
              <div class="text-2xl font-bold mb-1">FACILE</div>
              <div class="text-xs opacity-70">Pour les d√©butants</div>
            </button>
            <button id="diff-medium" onclick="selectDifficulty('medium')" class="difficulty-card relative p-6 rounded-lg border border-yellow-500 bg-yellow-900/20 text-yellow-400 transition-all">
              <div class="text-2xl font-bold mb-1">MOYEN</div>
              <div class="text-xs opacity-70">Niveau 3 requis</div>
            </button>
            <button id="diff-hard" onclick="selectDifficulty('hard')" class="difficulty-card relative p-6 rounded-lg border border-red-500 bg-red-900/20 text-red-400 transition-all">
              <div class="text-2xl font-bold mb-1">DIFFICILE</div>
              <div class="text-xs opacity-70">Niveau 7 requis</div>
            </button>
            <button id="diff-hardcore" onclick="selectDifficulty('hardcore')" class="difficulty-card relative p-6 rounded-lg border border-purple-500 bg-purple-900/20 text-purple-400 transition-all">
              <div class="text-2xl font-bold mb-1"><i class="fas fa-skull"></i> HARDCORE</div>
              <div class="text-xs opacity-70">Niveau 12 requis</div>
            </button>
          </div>
        </div>

        <!-- √âCRAN DU QUIZ -->
        <div id="quiz-screen" class="hidden">
          <div class="flex justify-between items-start mb-2">
            <button onclick="showDifficultyScreen()" class="text-gray-500 hover:text-white transition-colors text-sm"><i class="fas fa-arrow-left"></i> Changer difficult√©</button>
            <span id="current-difficulty-badge" class="px-2 py-1 rounded text-xs font-bold bg-gray-800 text-gray-400">MOYEN</span>
          </div>

          <div class="mb-2">
            <h2 id="game-title" class="text-xl md:text-2xl theme-text-primary tracking-widest opacity-80">JEU</h2>
          </div>

          <!-- En-t√™te du Quiz -->
          <div class="flex justify-between items-end mb-6 border-b border-gray-700 pb-4">
            <div class="text-left">
              <span class="text-xs text-gray-500 uppercase tracking-widest">Question</span>
              <div class="text-2xl font-bold theme-text-primary"><span id="current-q-num">1</span><span class="text-sm text-gray-500">/5</span></div>
            </div>
            <div class="text-right">
              <span class="text-xs text-gray-500 uppercase tracking-widest">Score</span>
              <div class="text-2xl font-bold theme-text-primary" id="score-display">0</div>
            </div>
          </div>

          <!-- Barre de progression -->
          <div class="w-full h-1 bg-gray-800 mb-8 relative rounded-full overflow-hidden">
            <div id="progress-bar" class="absolute top-0 left-0 h-full theme-bg-primary transition-all duration-500" style="width: 0%"></div>
          </div>

          <!-- Conteneur Question -->
          <div class="min-h-[100px] flex items-center justify-center mb-8">
            <h3 id="question-text" class="text-xl md:text-2xl font-medium text-white">Chargement...</h3>
          </div>

          <!-- Options de r√©ponse -->
          <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            <!-- Boutons g√©n√©r√©s par JS -->
          </div>

          <!-- Message de feedback -->
          <div id="feedback-msg" class="h-6 text-sm font-bold tracking-wider opacity-0 transition-opacity duration-300"></div>
        </div>

        <!-- √âCRAN DE R√âSULTAT -->
        <div id="result-screen" class="hidden">
          <div class="mb-6">
            <div class="text-6xl mb-4 theme-text-primary animate-bounce">
              <i class="fas fa-trophy"></i>
            </div>
            <h2 class="text-3xl font-bold theme-text-primary mb-1" id="end-title">TERMINE</h2>
            <p class="theme-text-secondary text-sm uppercase tracking-widest mb-6" id="end-rank">Rang : ???</p>
          </div>

          <div class="bg-black/40 border border-gray-700 p-6 mb-8 max-w-sm mx-auto rounded-lg">
            <div class="text-gray-400 text-sm uppercase mb-2">Score Final</div>
            <div class="text-5xl font-bold text-white mb-2"><span id="final-score">0</span><span class="text-2xl text-gray-600">/5</span></div>
            <p id="rank-desc" class="text-sm text-gray-400 italic">Description...</p>
          </div>

          <div class="flex flex-col md:flex-row gap-4 justify-center">
            <button onclick="restartQuiz()" class="theme-btn px-8 py-3 text-sm font-bold uppercase tracking-wider rounded">Rejouer (M√™me difficult√©)</button>
            <button
              onclick="showDifficultyScreen()"
              class="px-8 py-3 text-sm font-bold uppercase tracking-wider text-gray-400 hover:text-white transition-colors border border-transparent hover:border-gray-600 rounded"
            >
              Changer Difficult√©
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- XP Notification (Floating) -->
    <div id="xp-notification">
      <div id="xp-amount" class="text-3xl font-black theme-text-primary">+0 XP</div>
      <div id="xp-reason" class="text-xs text-gray-400 mb-2">Quiz termin√©</div>
      <div id="xp-levelup" class="hidden">
        <div class="level-up-banner text-lg">LEVEL UP ! üéâ</div>
        <div id="xp-newlevel" class="text-sm font-bold text-white">Niveau 2</div>
      </div>
      <div id="xp-unlocked" class="text-xs text-green-500 font-bold mt-1 hidden">
        <i class="fas fa-lock-open mr-1"></i> Nouveau jeu d√©bloqu√© !
      </div>
    </div>

    <script>
      // --- SYST√àME DE PROGRESSION & AUTH ---
      const XP_LEVELS = [0, 100, 250, 450, 700, 1000, 1300, 1550, 1800, 2500, 3500, 5000, 7000, 9500, 12500];
      const GAME_UNLOCKS = {
        minecraft: 1, mario: 1, pokemon: 1,
        fortnite: 2, gta: 3, valorant: 4, lol: 5,
        zelda: 6, ac: 7, tekken: 9, ratchet: 11, gow: 13
      };
      const DIFF_UNLOCKS = { easy: 1, medium: 3, hard: 7, hardcore: 12 };
      const XP_PER_ANSWER = { easy: 10, medium: 20, hard: 35, hardcore: 60 };
      const XP_BONUS_COMPLETION = { easy: 20, medium: 40, hard: 80, hardcore: 150 };

      const BADGES = [
        { id: 'first_quiz', name: 'Premier Quiz', icon: 'fa-gamepad', desc: 'Compl√©ter 1 quiz' },
        { id: 'perfect_score', name: 'Score Parfait', icon: 'fa-star', desc: '100% √† n' + "'" + 'importe quel quiz' },
        { id: 'level_5', name: 'Niveau 5', icon: 'fa-dumbbell', desc: 'Atteindre le niveau 5' },
        { id: 'level_10', name: 'Niveau 10', icon: 'fa-fire', desc: 'Atteindre le niveau 10' },
        { id: 'level_max', name: 'Niveau Max', icon: 'fa-crown', desc: 'Atteindre le niveau 15' },
        { id: 'explorer', name: 'Explorateur', icon: 'fa-map', desc: 'Jouer √† 6 jeux diff√©rents' },
        { id: 'collector', name: 'Collectionneur', icon: 'fa-globe', desc: 'Jouer √† tous les jeux' },
        { id: 'hardcore_fan', name: 'Hardcore Fan', icon: 'fa-skull', desc: 'Terminer un quiz Hardcore' },
        { id: 'hardcore_master', name: 'Master Hardcore', icon: 'fa-trophy', desc: 'Score parfait en Hardcore' },
        { id: 'polyglot', name: 'Polyglotte', icon: 'fa-book', desc: 'Jouer aux 4 difficult√©s' },
        { id: 'fast', name: 'Rapide', icon: 'fa-bolt', desc: '50 quiz jou√©s' },
        { id: 'sniper', name: 'Sniper', icon: 'fa-crosshairs', desc: 'Score parfait 5√ó' }
      ];

      // Fonctions de hachage et donn√©es
      const simpleHash = str => {
        let hash = 0;
        for (let i = 0; i < str.length; i++) hash += str.charCodeAt(i) * (i + 1);
        return hash.toString(36);
      };

      const getUsers = () => JSON.parse(localStorage.getItem('bq_users') || '[]');
      const saveUsers = users => localStorage.setItem('bq_users', JSON.stringify(users));
      const getCurrentUser = () => {
        const username = localStorage.getItem('bq_current_user');
        return username ? getUsers().find(u => u.username === username) : null;
      };

      const getLevelFromXP = xp => {
        let level = 1;
        for (let i = XP_LEVELS.length - 1; i >= 0; i--) {
          if (xp >= XP_LEVELS[i]) {
            level = i + 1;
            break;
          }
        }
        const nextXP = XP_LEVELS[level] || XP_LEVELS[XP_LEVELS.length - 1];
        const currentLevelXP = XP_LEVELS[level - 1];
        const progress = level >= 15 ? 100 : ((xp - currentLevelXP) / (nextXP - currentLevelXP)) * 100;
        return { level, nextXP, progress };
      };

      const isGameUnlocked = (gameId, level) => level >= (GAME_UNLOCKS[gameId] || 1);
      const isDifficultyUnlocked = (diff, level) => level >= (DIFF_UNLOCKS[diff] || 1);

      // --- AUTH LOGIC ---
      function switchAuthTab(tab) {
        document.getElementById('tab-login').classList.toggle('active', tab === 'login');
        document.getElementById('tab-signup').classList.toggle('active', tab === 'signup');
        document.getElementById('login-form').classList.toggle('hidden', tab !== 'login');
        document.getElementById('signup-form').classList.toggle('hidden', tab !== 'signup');
        document.getElementById('auth-error').classList.add('hidden');
      }

      function handleLogin() {
        const user = document.getElementById('login-username').value.trim();
        const pass = document.getElementById('login-password').value;
        const errorEl = document.getElementById('auth-error');

        if (!user || !pass) {
          errorEl.textContent = "Veuillez remplir tous les champs.";
          errorEl.classList.remove('hidden');
          return;
        }

        const users = getUsers();
        const found = users.find(u => u.username === user && u.passwordHash === simpleHash(pass));

        if (found) {
          localStorage.setItem('bq_current_user', user);
          initApp();
        } else {
          errorEl.textContent = "Identifiants incorrects.";
          errorEl.classList.remove('hidden');
        }
      }

      function handleSignup() {
        const user = document.getElementById('signup-username').value.trim();
        const pass = document.getElementById('signup-password').value;
        const errorEl = document.getElementById('auth-error');

        if (!user || !pass) {
          errorEl.textContent = "Veuillez remplir tous les champs.";
          errorEl.classList.remove('hidden');
          return;
        }

        const users = getUsers();
        if (users.find(u => u.username === user)) {
          errorEl.textContent = "Ce nom d'utilisateur existe d√©j√†.";
          errorEl.classList.remove('hidden');
          return;
        }

        const newUser = {
          username: user,
          passwordHash: simpleHash(pass),
          xp: 0,
          level: 1,
          quizzesPlayed: 0,
          bestScores: {},
          badges: [],
          playedGames: [],
          playedDiffs: [],
          perfectScoresCount: 0,
          createdAt: new Date().toISOString()
        };

        users.push(newUser);
        saveUsers(users);
        localStorage.setItem('bq_current_user', user);
        initApp();
      }

      function logout() {
        localStorage.removeItem('bq_current_user');
        location.reload();
      }

      function resetProgress() {
        if (!confirm("Voulez-vous vraiment r√©initialiser toute votre progression ? (XP, niveaux, badges, records)")) return;
        const user = getCurrentUser();
        const users = getUsers();
        const index = users.findIndex(u => u.username === user.username);
        
        users[index] = {
          ...users[index],
          xp: 0,
          level: 1,
          quizzesPlayed: 0,
          bestScores: {},
          badges: [],
          playedGames: [],
          playedDiffs: [],
          perfectScoresCount: 0
        };
        
        saveUsers(users);
        location.reload();
      }

      function deleteAccount() {
        if (!confirm("Voulez-vous vraiment supprimer votre compte ? Cette action est irr√©versible.")) return;
        const user = getCurrentUser();
        let users = getUsers();
        users = users.filter(u => u.username !== user.username);
        saveUsers(users);
        logout();
      }

      // Raccourci de test (Ctrl+Shift+R pour r√©initialiser le localStorage)
      window.addEventListener('keydown', e => {
        if (e.ctrlKey && e.shiftKey && e.key === 'R') {
          if (confirm("R√©initialiser TOUTES les donn√©es (tous les comptes) ?")) {
            localStorage.clear();
            location.reload();
          }
        }
      });

      // --- DONN√âES DES JEUX ---
      // Structure: { gameId: { title, theme, ranks, questions: { easy: [], medium: [], hard: [], hardcore: [] } } }

      const gamesData = {
        lol: {
          title: "League of Legends",
          theme: { primary: "#C8AA6E", secondary: "#0AC8B9", bgStart: "#091428", bgEnd: "#010a13", fontTitle: "'Cinzel', serif", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Qui est la s≈ìur de Jinx ?", options: ["Caitlyn", "Vi", "Lux", "Ashe"], correct: 1 },
              { q: "Quelle est la r√©gion de Garen ?", options: ["Noxus", "Demacia", "Ionia", "Freljord"], correct: 1 },
              { q: "Qui pose des champignons toxiques ?", options: ["Teemo", "Twitch", "Singed", "Cassiopeia"], correct: 0 },
              { q: "Comment s'appelle l'ours d'Annie ?", options: ["Tibbers", "Volibear", "Daisy", "Gnar"], correct: 0 },
              { q: "Qui utilise des cartes magiques ?", options: ["Twisted Fate", "Ryze", "Ezreal", "Graves"], correct: 0 },
              { q: "Quelle est la couleur du mana ?", options: ["Rouge", "Bleu", "Vert", "Jaune"], correct: 1 },
              { q: "Combien y a-t-il de lanes sur la Faille de l'Invocateur ?", options: ["2", "3", "4", "1"], correct: 1 },
            ],
            medium: [
              { q: "De quelle r√©gion Swain est-il le Grand G√©n√©ral ?", options: ["Demacia", "Noxus", "Ionia", "Shurima"], correct: 1 },
              { q: "Qui a forg√© les armes d'Ornn ?", options: ["Ornn lui-m√™me", "Volibear", "Anivia", "Braum"], correct: 0 },
              { q: "Quel est le v√©ritable nom du Roi D√©chu ?", options: ["Mordekaiser", "Viego", "Yorick", "Thresh"], correct: 1 },
              { q: "Qui est le fr√®re de Yasuo ?", options: ["Yone", "Zed", "Shen", "Kayn"], correct: 0 },
              { q: "Quel Darkin est un arc ?", options: ["Aatrox", "Rhaast", "Varus", "Naafiri"], correct: 2 },
              { q: "Qui a fond√© l'Acad√©mie de Piltover ?", options: ["Heimerdinger", "Jayce", "Viktor", "Camille"], correct: 0 },
              { q: "Quel est le nom du chat de Yuumi ?", options: ["Book", "Norra", "Yuumi", "Mimi"], correct: 1 },
            ],
            hard: [
              { q: "Quel est le nom du d√©mon √† l'int√©rieur de Swain ?", options: ["Raum", "Evelynn", "Tahm Kench", "Fiddlesticks"], correct: 0 },
              { q: "De quelle tribu Ashe est-elle la chef ?", options: ["Avarosan", "Griffes Hivernales", "Gardiens du Givre", "Ursine"], correct: 0 },
              { q: "Qui a cr√©√© Blitzcrank ?", options: ["Heimerdinger", "Viktor", "Singed", "Jayce"], correct: 1 },
              { q: "Quel est le vrai nom de Jhin ?", options: ["Khada Jhin", "Govos", "Usan", "Inconnu"], correct: 0 },
              { q: "Qui a tu√© les parents de Vayne ?", options: ["Evelynn", "Fiddlesticks", "Nocturne", "Swain"], correct: 0 },
              { q: "Comment s'appelle l'√©p√©e de Viego ?", options: ["Lame du Roi D√©chu", "Sanctity", "Soulreaver", "Zweihander"], correct: 1 },
              { q: "Quel champion est surnomm√© 'La Col√®re de Zaun' ?", options: ["Warwick", "Urgot", "Zac", "Mundo"], correct: 0 },
            ],
            hardcore: [
              { q: "Combien y a-t-il de Darkin connus actuellement ?", options: ["3", "4", "5", "6"], correct: 1 },
              { q: "Quel est le nom de l'arme de Jayce ?", options: ["Marteau Mercury", "Hextech Gun", "Cannon Spark", "Hammer Time"], correct: 0 },
              { q: "Dans quelle ville Ryze cache-t-il les Runes ?", options: ["Sous le fort de Demacia", "Dans la for√™t de Petricite", "Dans le coffre runique", "Il les garde sur lui"], correct: 1 },
              { q: "Quel √©tait le nom humain de Kalista ?", options: ["Kalista", "Isolde", "Ledros", "Hecarim"], correct: 0 },
              { q: "Quel Aspect habite Atreus (Pantheon) ?", options: ["La Guerre", "Le Soleil", "La Lune", "La Protection"], correct: 0 },
              { q: "Qui est la s≈ìur de Kayle ?", options: ["Morgana", "Leona", "Diana", "Quinn"], correct: 0 },
              { q: "Quelle est la prime sur la t√™te de Twisted Fate et Graves ?", options: ["Morte ou vive", "Un empire", "Inestimable", "Double"], correct: 0 },
            ],
          },
        },
        valorant: {
          title: "VALORANT",
          theme: { primary: "#ff4655", secondary: "#ECE8E1", bgStart: "#0f1923", bgEnd: "#000000", fontTitle: "'Oswald', sans-serif", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Combien de rounds pour gagner (non-class√©/comp√©titif) ?", options: ["13", "12", "15", "10"], correct: 0 },
              { q: "Quel agent soigne ses alli√©s ?", options: ["Jett", "Sage", "Raze", "Omen"], correct: 1 },
              { q: "Quel agent vient de Cor√©e du Sud ?", options: ["Jett", "Phoenix", "Yoru", "Sova"], correct: 0 },
              { q: "Comment s'appelle la bombe ?", options: ["C4", "Spike", "Bomb", "Device"], correct: 1 },
              { q: "Quel agent utilise un arc ?", options: ["Sova", "Skye", "Breach", "KAY/O"], correct: 0 },
              { q: "Combien d'agents y a-t-il par √©quipe ?", options: ["4", "5", "6", "10"], correct: 1 },
              { q: "Quelle arme est un sniper ?", options: ["Operator", "Vandal", "Judge", "Shorty"], correct: 0 },
            ],
            medium: [
              { q: "Quel est le co√ªt d'une Vandal ?", options: ["2700", "2900", "3100", "2500"], correct: 1 },
              { q: "Combien de sites poss√®de la carte Haven ?", options: ["2", "3", "4", "1"], correct: 1 },
              { q: "Quel est le r√¥le de Reyna ?", options: ["Sentinelle", "Duelliste", "Contr√¥leur", "Initiateur"], correct: 1 },
              { q: "Qui a cr√©√© Killjoy ?", options: ["Kingdom", "Elle-m√™me", "Raze", "Brimstone"], correct: 1 },
              { q: "Quelle capacit√© ultime permet de se t√©l√©porter n'importe o√π ?", options: ["Depuis les ombres", "Voyage interdimensionnel", "Portail", "Saut √©clair"], correct: 0 },
              { q: "Quel agent utilise des tourelles ?", options: ["Killjoy", "Cypher", "Chamber", "Raze"], correct: 0 },
              { q: "Quelle est la devise de Valorant ?", options: ["Defy the Limits", "To the moon", "Play hard", "Victory"], correct: 0 },
            ],
            hard: [
              { q: "Quel est le vrai nom de Brimstone ?", options: ["Liam Byrne", "James", "Sarge", "Stone"], correct: 0 },
              { q: "De quel pays vient Chamber ?", options: ["Belgique", "Suisse", "France", "Monaco"], correct: 2 },
              { q: "Quel est le nom de l'organisation antagoniste ?", options: ["Kingdom", "Omega Earth", "Atlas", "Legion"], correct: 1 },
              { q: "Quel agent est un radianite naturel (pas de technologie) ?", options: ["Brimstone", "Viper", "Phoenix", "Killjoy"], correct: 2 },
              { q: "Quel animal repr√©sente le gunbuddy de Skye ?", options: ["Loup", "Oiseau", "Faucon", "Tigre"], correct: 2 },
              { q: "Sur quelle map trouve-t-on des t√©l√©porteurs ?", options: ["Bind", "Split", "Haven", "Ascent"], correct: 0 },
              { q: "Quel agent a perdu son bras ?", options: ["Breach", "Sova", "Brimstone", "Omen"], correct: 0 },
            ],
            hardcore: [
              { q: "Quel est le code pour d√©samorcer le Spike ?", options: ["7355608", "Alpha-Omega", "Il n'y en a pas", "L'agent tape au hasard"], correct: 2 },
              { q: "Quelle carte se d√©roule au Portugal ?", options: ["Pearl", "Breeze", "Ascent", "Split"], correct: 0 },
              { q: "Quel est le matricule de l'agent Reyna ?", options: ["10", "11", "07", "01"], correct: 1 },
              { q: "Qui a vol√© le bras de Breach ?", options: ["Raze", "Personne, n√© sans", "Accident", "La justice"], correct: 3 },
              { q: "Quel agent √©tait un tueur √† gages ?", options: ["Chamber", "Omen", "Cypher", "Yoru"], correct: 0 },
              { q: "Combien de d√©g√¢ts fait un coup de couteau dans le dos (clic droit) ?", options: ["100", "150", "75", "200"], correct: 1 },
              { q: "Quel est le nom du Kingdom sur la Terre Omega ?", options: ["Kingdom Industries", "Atlas", "Legion", "Omega Corp"], correct: 0 },
            ],
          },
        },
        gta: {
          title: "Grand Theft Auto",
          theme: { primary: "#4caf50", secondary: "#ffffff", bgStart: "#1a1a1a", bgEnd: "#000000", fontTitle: "'Oswald', sans-serif", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Dans quelle ville se passe GTA V ?", options: ["Liberty City", "Vice City", "Los Santos", "San Fierro"], correct: 2 },
              { q: "Qui est le h√©ros de GTA San Andreas ?", options: ["CJ", "Franklin", "Tommy", "Niko"], correct: 0 },
              { q: "Quelle couleur pour le gang Grove Street ?", options: ["Vert", "Violet", "Jaune", "Bleu"], correct: 0 },
              { q: "Qui est le psychopathe de GTA V ?", options: ["Michael", "Franklin", "Trevor", "Lester"], correct: 2 },
              { q: "Quel v√©hicule est un tank ?", options: ["Rhino", "Infernus", "Faggio", "Buzzard"], correct: 0 },
              { q: "Combien de personnages jouables dans GTA V ?", options: ["1", "2", "3", "4"], correct: 2 },
              { q: "Comment s'appelle l'application sur le t√©l√©phone dans GTA V ?", options: ["iFruit", "FruitOS", "Badger", "Eyefind"], correct: 0 },
            ],
            medium: [
              { q: "Qui est le cousin de Niko Bellic ?", options: ["Roman", "Dimitri", "Brucie", "Jacob"], correct: 0 },
              { q: "Comment s'appelle le chien de Franklin ?", options: ["Chop", "Rex", "Doggo", "Buster"], correct: 0 },
              { q: "Quelle √Æle a √©t√© ajout√©e dans GTA Online ?", options: ["Cayo Perico", "North Yankton", "Guarma", "San Fierro"], correct: 0 },
              { q: "Quel est le nom de famille de Michael ?", options: ["Townley", "De Santa", "Philips", "Clinton"], correct: 1 },
              { q: "Dans GTA SA, que faut-il suivre ?", options: ["Le train", "La voiture", "L'avion", "Le bateau"], correct: 0 },
              { q: "Quel est le m√©tier de Lester ?", options: ["Hacker", "Tueur", "Chauffeur", "Banquier"], correct: 0 },
              { q: "Dans quelle ville se passe GTA IV ?", options: ["Liberty City", "Vice City", "Los Santos", "London"], correct: 0 },
            ],
            hard: [
              { q: "Quel est le nom du culte dans GTA V ?", options: ["Epsilon Program", "Altruistes", "Les enfants de la montagne", "Tous les trois"], correct: 3 },
              { q: "Qui a trahi CJ dans San Andreas ?", options: ["Big Smoke & Ryder", "Sweet", "Kendl", "Cesar"], correct: 0 },
              { q: "En quelle ann√©e se d√©roule GTA Vice City ?", options: ["1984", "1986", "1992", "2001"], correct: 1 },
              { q: "Quel protagoniste est muet ?", options: ["Claude (GTA III)", "Tommy Vercetti", "CJ", "Niko"], correct: 0 },
              { q: "Quel est le vrai nom de Big Smoke ?", options: ["Melvin Harris", "Lance Wilson", "Carl Johnson", "Sean Sweet"], correct: 0 },
              { q: "Quelle banque est braqu√©e au d√©but de GTA V ?", options: ["Bobcat", "Fleeca", "Maze Bank", "Pacific Standard"], correct: 0 },
              { q: "Qui est le mentor de Franklin ?", options: ["Michael", "Lamar", "Trevor", "Simeon"], correct: 0 },
            ],
            hardcore: [
              { q: "Quel est le code pour le Jetpack dans San Andreas (PC) ?", options: ["ROCKETMAN", "HESOYAM", "AEZAKMI", "FULLCLIP"], correct: 0 },
              { q: "Qui est le p√®re de Tracey et Jimmy ?", options: ["Michael", "Trevor", "Amanda", "Brad"], correct: 0 },
              { q: "Dans quelle mission Michael d√©truit une maison ?", options: ["Marriage Counseling", "Father/Son", "Friend Request", "The Big Score"], correct: 0 },
              { q: "Quel acteur double Trevor Philips ?", options: ["Steven Ogg", "Ned Luke", "Shawn Fonteno", "Ray Liotta"], correct: 0 },
              { q: "Quelle radio joue 'Lady (Hear Me Tonight)' dans GTA V ?", options: ["Non-Stop Pop FM", "Radio Los Santos", "Space 103.2", "West Coast Classics"], correct: 0 },
              { q: "Quel est le nom du fant√¥me sur le Mont Gordo ?", options: ["Jolene Cranley", "Leonora Johnson", "Ursula", "Mary-Ann"], correct: 0 },
              { q: "En quelle ann√©e est sorti le tout premier GTA ?", options: ["1997", "1995", "1999", "2001"], correct: 0 },
            ],
          },
        },
        minecraft: {
          title: "Minecraft",
          theme: { primary: "#8bc34a", secondary: "#795548", bgStart: "#2d2d2d", bgEnd: "#1a1a1a", fontTitle: "'Press Start 2P', cursive", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Quel mob explose ?", options: ["Zombie", "Creeper", "Squelette", "Enderman"], correct: 1 },
              { q: "Quel outil pour miner de la pierre ?", options: ["Pelle", "Hache", "Pioche", "Houe"], correct: 2 },
              { q: "Comment s'appelle le monde infernal ?", options: ["Le Nether", "L'End", "L'Aether", "La Cave"], correct: 0 },
              { q: "Que donnent les moutons ?", options: ["Laine", "Cuir", "Plumes", "Oeufs"], correct: 0 },
              { q: "Quel minerai est le plus commun ?", options: ["Charbon", "Fer", "Diamant", "Emeraude"], correct: 0 },
              { q: "De quelle couleur est un Creeper ?", options: ["Vert", "Bleu", "Rouge", "Jaune"], correct: 0 },
              { q: "Que fait un Enderman si on le regarde ?", options: ["Il attaque", "Il danse", "Il disparait", "Rien"], correct: 0 },
            ],
            medium: [
              { q: "Combien de fer pour un plastron ?", options: ["6", "7", "8", "9"], correct: 2 },
              { q: "Qui est le boss final ?", options: ["Wither", "Ender Dragon", "Elder Guardian", "Warden"], correct: 1 },
              { q: "Quel bloc repousse les pistons ?", options: ["Obsidienne", "Pierre", "Bois", "Sable"], correct: 0 },
              { q: "Comment apprivoiser un chat ?", options: ["Saumon cru", "Os", "Bl√©", "Graines"], correct: 0 },
              { q: "Que faut-il pour faire un portail du Nether ?", options: ["10 Obsidiennes", "8 Obsidiennes", "12 Obsidiennes", "14 Obsidiennes minimum"], correct: 0 },
              { q: "Quelle cr√©ature d√©fend les temples sous-marins ?", options: ["Gardien", "Noy√©", "Dauphin", "Poulpe"], correct: 0 },
              { q: "Quel objet sert √† voler ?", options: ["Elytra", "Cape", "Plume", "Potion"], correct: 0 },
            ],
            hard: [
              { q: "Quel est le nom du cr√©ateur de Minecraft ?", options: ["Notch", "Jeb", "Dinnerbone", "C418"], correct: 0 },
              { q: "Quelle cr√©ature donne une Membrane de Fant√¥me ?", options: ["Phantom", "Ghast", "Vex", "Chauve-souris"], correct: 0 },
              { q: "Combien de biblioth√®ques pour l'enchantement max (niv 30) ?", options: ["12", "15", "16", "20"], correct: 1 },
              { q: "Quelle est la hauteur maximale de construction (v1.18+) ?", options: ["256", "320", "512", "128"], correct: 1 },
              { q: "Quel enchantement permet de marcher sur l'eau ?", options: ["Semelles givrantes", "Agilit√© aquatique", "Chute amortie", "Apn√©e"], correct: 0 },
              { q: "Quel est le bloc le plus r√©sistant (cassable) ?", options: ["Obsidienne", "Bedrock", "Netherite", "Ancient Debris"], correct: 0 },
              { q: "Comment obtenir une pomme de Notch (Enchant√©e) ?", options: ["Dans les coffres", "Crafting", "Sur les arbres", "Villageois"], correct: 0 },
            ],
            hardcore: [
              { q: "Combien de ticks y a-t-il dans une seconde r√©elle ?", options: ["10", "20", "30", "60"], correct: 1 },
              { q: "Quel est l'ID num√©rique de la pierre (avant 1.13) ?", options: ["1", "2", "3", "4"], correct: 0 },
              { q: "Quelle est la probabilit√© d'un mouton rose naturel ?", options: ["0.164%", "1%", "5%", "0.01%"], correct: 0 },
              { q: "Qui est 'Herobrine' ?", options: ["Un mythe", "Le fr√®re de Notch", "Un boss cach√©", "Un virus"], correct: 0 },
              { q: "Comment obtenir une t√™te de Creeper en survie ?", options: ["Creeper charg√© le tue", "Butin rare", "Commerce", "Impossible"], correct: 0 },
              { q: "Quelle version a ajout√© l'Update Aquatic ?", options: ["1.13", "1.12", "1.14", "1.11"], correct: 0 },
              { q: "Combien d'yeux de l'End maximum peuvent √™tre d√©j√† plac√©s sur le portail ?", options: ["12", "0", "5", "Tous"], correct: 0 },
            ],
          },
        },
        tekken: {
          title: "TEKKEN",
          theme: { primary: "#FF3333", secondary: "#FFD700", bgStart: "#2a0a0a", bgEnd: "#000000", fontTitle: "'Oswald', sans-serif", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Qui est le personnage principal (souvent) ?", options: ["Kazuya", "Jin", "Heihachi", "Tous les trois"], correct: 3 },
              { q: "Quel animal est un combattant ?", options: ["Panda", "Chien", "Chat", "Cheval"], correct: 0 },
              { q: "Quel est le nom du tournoi ?", options: ["King of Iron Fist", "Mortal Kombat", "World Warrior", "Kumite"], correct: 0 },
              { q: "Quel personnage fait de la Capoeira ?", options: ["Eddy Gordo", "Hwoarang", "Law", "Paul"], correct: 0 },
              { q: "Qui a une coiffure tr√®s haute ?", options: ["Paul Phoenix", "Jin", "Kazuya", "Lee"], correct: 0 },
              { q: "Quel personnage est un robot ?", options: ["Jack", "Jin", "King", "Law"], correct: 0 },
              { q: "Quel est le nom de l'ours ?", options: ["Kuma", "Panda", "Roger", "Alex"], correct: 0 },
            ],
            medium: [
              { q: "Qui est le p√®re de Kazuya ?", options: ["Heihachi", "Jinpachi", "Jin", "Lars"], correct: 0 },
              { q: "Qui est le rival de Paul Phoenix ?", options: ["Kuma", "Law", "Steve", "Bryan"], correct: 0 },
              { q: "Quel robot imite les coups ?", options: ["Combot/Mokujin", "Jack", "Alisa", "Bryan"], correct: 0 },
              { q: "Qui porte un masque de Jaguar ?", options: ["King", "Marduk", "Armor King", "Les deux King"], correct: 3 },
              { q: "D'o√π vient Lili ?", options: ["Monaco", "France", "Japon", "USA"], correct: 0 },
              { q: "Quel personnage utilise une √©p√©e ?", options: ["Yoshimitsu", "Law", "Paul", "Hwoarang"], correct: 0 },
              { q: "Qui est le p√®re de Jin ?", options: ["Kazuya", "Heihachi", "Lars", "Lee"], correct: 0 },
            ],
            hard: [
              { q: "Qui est la m√®re de Jin ?", options: ["Jun Kazama", "Asuka Kazama", "Kazumi Mishima", "Michelle Chang"], correct: 0 },
              { q: "Quel est le style de combat de Hwoarang ?", options: ["Taekwondo", "Karat√©", "Judo", "Muay Thai"], correct: 0 },
              { q: "Qui est le p√®re de Lars Alexandersson ?", options: ["Heihachi", "Kazuya", "Jinpachi", "Lee"], correct: 0 },
              { q: "Dans Tekken 3, qui est le boss final ?", options: ["Ogre", "Heihachi", "Devil Jin", "Azazel"], correct: 0 },
              { q: "Qui est la femme de Heihachi ?", options: ["Kazumi", "Jun", "Michelle", "Anna"], correct: 0 },
              { q: "Quel personnage est un boxeur ?", options: ["Steve Fox", "Paul", "Law", "Lei"], correct: 0 },
              { q: "Qui est la soeur d'Anna Williams ?", options: ["Nina", "Julia", "Lili", "Asuka"], correct: 0 },
            ],
            hardcore: [
              { q: "Quel personnage n'appara√Æt que dans Tekken 4 ?", options: ["Miharu", "Christie", "Combot", "Personne"], correct: 3 },
              { q: "En quelle ann√©e est sorti le premier Tekken (Arcade) ?", options: ["1994", "1995", "1993", "1996"], correct: 0 },
              { q: "Quel est le nom de l'organisation de Kazuya ?", options: ["G Corporation", "Mishima Zaibatsu", "Violet Systems", "Manji Clan"], correct: 0 },
              { q: "Comment s'appelle l'√©p√©e de Yoshimitsu ?", options: ["Yoshimitsu", "Masamune", "Muramasa", "Kusanagi"], correct: 0 },
              { q: "Quel personnage a √©t√© remplac√© par Raven dans Tekken 5 ?", options: ["Kunimitsu", "Personne", "Master Raven", "Bruce"], correct: 1 },
              { q: "Qui a entra√Æn√© Jin Kazama ?", options: ["Heihachi", "Kazuya", "Paul", "Wang"], correct: 0 },
              { q: "Quel est le d√©mon de Jinpachi ?", options: ["Il n'a pas de nom", "Ogre", "Azazel", "Devil"], correct: 0 },
            ],
          },
        },
        ac: {
          title: "Assassin's Creed",
          theme: { primary: "#d4af37", secondary: "#A60000", bgStart: "#1a1a1a", bgEnd: "#000000", fontTitle: "'Cinzel', serif", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Quelle est l'arme embl√©matique des Assassins ?", options: ["Lame secr√®te", "√âp√©e", "Arc", "Hache"], correct: 0 },
              { q: "Quel h√©ros vit en Italie ?", options: ["Ezio", "Alta√Ør", "Connor", "Edward"], correct: 0 },
              { q: "Comment s'appelle le saut dans le foin ?", options: ["Saut de la foi", "Saut de l'ange", "Plongeon", "Chute libre"], correct: 0 },
              { q: "Qui sont les ennemis des Assassins ?", options: ["Les Templiers", "Les Romains", "Les Pirates", "Les Vikings"], correct: 0 },
              { q: "Quel est le d√©cor de AC Valhalla ?", options: ["Vikings", "√âgypte", "Gr√®ce", "R√©volution Fran√ßaise"], correct: 0 },
              { q: "Dans quel pays se passe AC Origins ?", options: ["√âgypte", "Gr√®ce", "Italie", "France"], correct: 0 },
              { q: "Qui est le h√©ros de AC Odyssey ?", options: ["Kassandra/Alexios", "Bayek", "Eivor", "Arno"], correct: 0 },
            ],
            medium: [
              { q: "Comment s'appelle la machine pour revivre les m√©moires ?", options: ["Animus", "Matrix", "Helix", "Abstergo"], correct: 0 },
              { q: "Qui est le protagoniste du premier jeu ?", options: ["Alta√Ør", "Ezio", "Desmond", "Bayek"], correct: 0 },
              { q: "Dans quelle ville se passe AC Unity ?", options: ["Paris", "Londres", "Rome", "Venise"], correct: 0 },
              { q: "Quel pirate est le h√©ros de Black Flag ?", options: ["Edward Kenway", "Barbe Noire", "Jack Sparrow", "Haytham"], correct: 0 },
              { q: "Quelle civilisation ancienne a cr√©√© les Fragments d'√âden ?", options: ["Isu", "Atlantes", "Aliens", "Dieux"], correct: 0 },
              { q: "Qui est le p√®re de Connor ?", options: ["Haytham Kenway", "Edward Kenway", "Charles Lee", "Achilles"], correct: 0 },
              { q: "Quel est le m√©tier de Desmond Miles ?", options: ["Barman", "Assassin", "Voleur", "Arch√©ologue"], correct: 0 },
            ],
            hard: [
              { q: "Qui est le descendant de Desmond Miles ?", options: ["Elijah", "William", "Clay", "Il n'en a pas"], correct: 0 },
              { q: "Quel est le vrai nom de Barbe Noire dans le jeu ?", options: ["Thatch", "Teach", "Vane", "Hornigold"], correct: 0 },
              { q: "Comment s'appelle la s≈ìur d'Evie Frye ?", options: ["Jacob", "Henry", "Lydia", "Elle n'a pas de s≈ìur"], correct: 3 },
              { q: "Quel Assassin est Russe ?", options: ["Nikolai Orelov", "Arbaaz Mir", "Shao Jun", "Yusuf"], correct: 0 },
              { q: "Qui a tu√© Alta√Ør ?", options: ["Personne (vieillesse)", "Abbas", "Al Mualim", "Gengis Khan"], correct: 0 },
              { q: "Quel est le nom de l'aigle de Bayek ?", options: ["Senu", "Ikaros", "Synin", "Eagle"], correct: 0 },
              { q: "Qui a fond√© l'Ordre des Templiers ?", options: ["Ca√Øn", "Alfred le Grand", "Hugues de Payns", "Rodrigo Borgia"], correct: 0 },
            ],
            hardcore: [
              { q: "Quel est le nom complet d'Ezio ?", options: ["Ezio Auditore da Firenze", "Ezio Auditore", "Ezio da Firenze", "Ezio Mario Auditore"], correct: 0 },
              { q: "Quel jeu introduit le Hookblade ?", options: ["Revelations", "Brotherhood", "AC III", "Unity"], correct: 0 },
              { q: "Qui est le Sage dans Black Flag ?", options: ["Bartholomew Roberts", "Woodes Rogers", "Torres", "Hornigold"], correct: 0 },
              { q: "Quelle ann√©e marque la fin du monde dans AC 3 ?", options: ["2012", "2000", "2020", "2010"], correct: 0 },
              { q: "Quel est le nom du fils d'Alta√Ør ?", options: ["Darim", "Sef", "Les deux", "Malik"], correct: 2 },
              { q: "Qui est le Sujet 16 ?", options: ["Clay Kaczmarek", "Desmond Miles", "Warren Vidic", "Daniel Cross"], correct: 0 },
              { q: "Dans quelle ville meurt Ezio ?", options: ["Florence", "Venise", "Rome", "Masyaf"], correct: 0 },
            ],
          },
        },
        mario: {
          title: "Super Mario",
          theme: { primary: "#FF0000", secondary: "#FFD700", bgStart: "#009ACD", bgEnd: "#00008B", fontTitle: "'Press Start 2P', cursive", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Qui est le fr√®re de Mario ?", options: ["Luigi", "Wario", "Yoshi", "Toad"], correct: 0 },
              { q: "Qui Mario doit-il sauver ?", options: ["Princesse Peach", "Princesse Daisy", "Pauline", "Rosalina"], correct: 0 },
              { q: "Quel est le m√©chant principal ?", options: ["Bowser", "Kamek", "Donkey Kong", "Roi Boo"], correct: 0 },
              { q: "Que mange Yoshi ?", options: ["Tout (ou presque)", "Champignons", "√âtoiles", "Fleurs"], correct: 0 },
              { q: "Quelle couleur est la casquette de Mario ?", options: ["Rouge", "Verte", "Jaune", "Bleue"], correct: 0 },
              { q: "Quel objet permet de lancer des boules de feu ?", options: ["Fleur de feu", "Champignon", "√âtoile", "Plume"], correct: 0 },
              { q: "Qui est le rival de Mario ?", options: ["Wario", "Waluigi", "Luigi", "Toad"], correct: 0 },
            ],
            medium: [
              { q: "Quel objet fait grandir Mario ?", options: ["Super Champignon", "Fleur de feu", "√âtoile", "Feuille"], correct: 0 },
              { q: "Quel est le nom du dinosaure vert ?", options: ["Yoshi", "Birdo", "Rex", "Koopa"], correct: 0 },
              { q: "Dans quel jeu Mario va-t-il dans l'espace ?", options: ["Super Mario Galaxy", "Sunshine", "Odyssey", "64"], correct: 0 },
              { q: "Qui est le partenaire de Wario ?", options: ["Waluigi", "Bowser", "Kamek", "Donkey Kong"], correct: 0 },
              { q: "Sur quelle console est sorti Super Mario 64 ?", options: ["Nintendo 64", "GameCube", "SNES", "Wii"], correct: 0 },
              { q: "Quel est le nom du fr√®re de Bowser ?", options: ["Il n'en a pas", "Morton", "Ludwig", "Kamek"], correct: 0 },
              { q: "Quelle princesse r√®gne sur Sarasaland ?", options: ["Daisy", "Peach", "Rosalina", "Pauline"], correct: 0 },
            ],
            hard: [
              { q: "Quel √©tait le premier nom de Mario ?", options: ["Jumpman", "Mr. Video", "Ossan", "Plumber"], correct: 0 },
              { q: "Quel est le m√©tier de Mario (officiellement) ?", options: ["Plombier", "Charpentier", "M√©decin", "Pilote"], correct: 0 },
              { q: "Comment s'appelle la machine √† eau dans Sunshine ?", options: ["J.E.T.", "F.L.U.D.D.", "A.Q.U.A.", "S.P.L.A.S.H."], correct: 1 },
              { q: "Qui est la m√®re de Bowser Jr. ?", options: ["Inconnu", "Peach", "Daisy", "Wendy"], correct: 0 },
              { q: "Quel jeu a introduit Rosalina (Harmonie) ?", options: ["Galaxy", "Galaxy 2", "3D World", "Mario Kart Wii"], correct: 0 },
              { q: "Quel est le nom du vaisseau dans Mario Odyssey ?", options: ["L'Odyss√©e", "L'Orion", "Le Mario", "Le Chapeau"], correct: 0 },
              { q: "Combien y a-t-il de Koopalings ?", options: ["7", "8", "6", "9"], correct: 0 },
            ],
            hardcore: [
              { q: "Dans quel jeu Mario est-il le m√©chant ?", options: ["Donkey Kong Jr.", "Donkey Kong", "Mario Bros.", "Wrecking Crew"], correct: 0 },
              { q: "Quel est le nom complet de Yoshi ?", options: ["T. Yoshisaur Munchakoopas", "Yoshida", "Yoshi Dino", "Juste Yoshi"], correct: 0 },
              { q: "Combien d'√©toiles y a-t-il dans Super Mario 64 ?", options: ["120", "121", "150", "100"], correct: 0 },
              { q: "Qui a compos√© le th√®me original de Mario ?", options: ["Koji Kondo", "Nobuo Uematsu", "Shigeru Miyamoto", "Kazumi Totaka"], correct: 0 },
              { q: "Quel Koopaling a une cr√™te multicolore ?", options: ["Lemmy", "Iggy", "Ludwig", "Larry"], correct: 0 },
              { q: "Quelle est la date de sortie de Super Mario Bros. au Japon ?", options: ["13 septembre 1985", "13 septembre 1983", "10 mars 1985", "1 janvier 1986"], correct: 0 },
              { q: "Quel personnage est jouable dans Super Mario Bros 2 mais pas le 1 ?", options: ["Peach", "Yoshi", "Wario", "Donkey Kong"], correct: 0 },
            ],
          },
        },
        ratchet: {
          title: "Ratchet: Gladiator",
          theme: { primary: "#F27200", secondary: "#004080", bgStart: "#101020", bgEnd: "#000000", fontTitle: "'Oswald', sans-serif", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Qui est le meilleur ami de Ratchet ?", options: ["Clank", "Qwark", "Al", "Talwyn"], correct: 0 },
              { q: "Quelle est l'arme de corps √† corps de Ratchet ?", options: ["Cl√© (Omniwrench)", "Marteau", "Sabre", "Poing"], correct: 0 },
              { q: "Dans Gladiator, que font Ratchet et Clank ?", options: ["Combattent dans une ar√®ne", "Sauvent l'univers", "Cherchent un tr√©sor", "Rarent les Lombax"], correct: 0 },
              { q: "De quelle couleur est Ratchet ?", options: ["Jaune/Orange", "Bleu", "Vert", "Gris"], correct: 0 },
              { q: "Qui pr√©sente l'√©mission DreadZone ?", options: ["Gleeman Vox", "Juanita & Dallas", "Qwark", "Nefarious"], correct: 1 },
              { q: "Comment s'appelle le petit robot ?", options: ["Clank", "Click", "Clunk", "Clock"], correct: 0 },
              { q: "Quel est le but des d√©fis ?", options: ["Survivre", "Dormir", "Manger", "Voler"], correct: 0 },
            ],
            medium: [
              { q: "Quel est le nom du m√©chant principal de Gladiator ?", options: ["Gleeman Vox", "Dr. Nefarious", "Drek", "Emperor Tachyon"], correct: 0 },
              { q: "Comment s'appellent les robots de combat de Ratchet ?", options: ["Bots de combat", "Mercenaires", "Galactic Rangers", "Zoni"], correct: 0 },
              { q: "Quelle est l'esp√®ce de Ratchet ?", options: ["Lombax", "Blarg", "Cragmite", "Humain"], correct: 0 },
              { q: "Quelle arme tire des scorpions/lave ?", options: ["Le Scorpion", "Le Magma", "Le Fl√©au", "Le Harbringer"], correct: 2 },
              { q: "Dans quelle station se d√©roule le jeu ?", options: ["DreadZone", "Station Q9", "Veldin", "Metropolis"], correct: 0 },
              { q: "Quel est le grade de Ratchet ?", options: ["Gladiateur", "Soldat", "Capitaine", "G√©n√©ral"], correct: 0 },
              { q: "Que portent les h√©ros autour du cou ?", options: ["Un collier explosif", "Une m√©daille", "Une √©charpe", "Rien"], correct: 0 },
            ],
            hard: [
              { q: "Quel est le nom de l'√©quipe de Ratchet ?", options: ["Team DarkStar", "Team Hero", "Team Lombax", "Team Qwark"], correct: 0 },
              { q: "Quel ancien h√©ros est devenu un Exterminator ?", options: ["Ace Hardlight", "Shellshock", "Reactor", "Eviscerator"], correct: 0 },
              { q: "Quel est le niveau maximum des armes (Omega) ?", options: ["99", "10", "5", "50"], correct: 0 },
              { q: "Comment s'appelle le collier explosif ?", options: ["Deadlock", "DeathCollar", "DoomDevice", "ExploNeck"], correct: 0 },
              { q: "Qui est le premier boss Exterminator ?", options: ["Shellshock", "Reactor", "Eviscerator", "Ace"], correct: 0 },
              { q: "Quelle plan√®te est la plan√®te natale de Ratchet ?", options: ["Fastoon", "Veldin", "Kerwan", "Novalis"], correct: 0 },
              { q: "Qui est le chef des Exterminators ?", options: ["Ace Hardlight", "Vox", "Reactor", "Slugga"], correct: 0 },
            ],
            hardcore: [
              { q: "Quel est le nom original US du jeu ?", options: ["Deadlocked", "Gladiator", "Arena", "Warzone"], correct: 0 },
              { q: "Quel cheat code est d√©bloqu√© avec tous les points de comp√©tence ?", options: ["Mode Ninja", "Invincibilit√©", "Munitions illimit√©es", "M√©t√©o"], correct: 0 },
              { q: "Combien y a-t-il de points de comp√©tence ?", options: ["165", "100", "50", "150"], correct: 0 },
              { q: "Quel est le nom du vaisseau de Vox ?", options: ["Dreadnought", "Vox Populi", "Battledome", "Vox's Pride"], correct: 2 },
              { q: "Quel personnage de Jak & Daxter appara√Æt comme skin ?", options: ["Jak", "Daxter", "Pecker", "Samos"], correct: 0 },
              { q: "Quel est le nom du mode coop√©ratif ?", options: ["Il n'y en a pas", "Co-op", "Squad Mode", "Duo"], correct: 1 },
              { q: "Quel studio a d√©velopp√© ce jeu ?", options: ["Insomniac Games", "Naughty Dog", "Sucker Punch", "Guerrilla"], correct: 0 },
            ],
          },
        },
        zelda: {
          title: "The Legend of Zelda",
          theme: { primary: "#FFD700", secondary: "#2E8B57", bgStart: "#006400", bgEnd: "#000000", fontTitle: "'Cinzel', serif", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Comment s'appelle le h√©ros ?", options: ["Link", "Zelda", "Ganon", "Tingle"], correct: 0 },
              { q: "Qui est la princesse ?", options: ["Zelda", "Peach", "Midna", "Impa"], correct: 0 },
              { q: "Quel est le m√©chant principal ?", options: ["Ganon/Ganondorf", "Vaati", "Zant", "Majora"], correct: 0 },
              { q: "Quelle est l'arme embl√©matique de Link ?", options: ["L'√âp√©e de L√©gende (Master Sword)", "Hache", "Lance", "B√¢ton"], correct: 0 },
              { q: "Quelle forme a la Triforce ?", options: ["Triangles", "Cercles", "Carr√©s", "√âtoiles"], correct: 0 },
              { q: "Quelle est la monnaie du jeu ?", options: ["Rubis", "Pi√®ces", "Gils", "Anneaux"], correct: 0 },
              { q: "Quelle couleur porte Link habituellement ?", options: ["Vert", "Rouge", "Bleu", "Jaune"], correct: 0 },
            ],
            medium: [
              { q: "Dans quel jeu Link se transforme-t-il en loup ?", options: ["Twilight Princess", "Ocarina of Time", "Majora's Mask", "Skyward Sword"], correct: 0 },
              { q: "Quel instrument joue Link dans Ocarina of Time ?", options: ["Ocarina", "Fl√ªte", "Guitare", "Piano"], correct: 0 },
              { q: "Quel peuple vit dans l'eau ?", options: ["Zoras", "Gorons", "Piafs", "Gerudos"], correct: 0 },
              { q: "Qui est Sheik ?", options: ["Zelda", "Impa", "Link", "Ganon"], correct: 0 },
              { q: "Quel jeu a introduit le style 'Cartoon' ?", options: ["The Wind Waker", "A Link to the Past", "Twilight Princess", "Breath of the Wild"], correct: 0 },
              { q: "Quel est le nom du cheval de Link ?", options: ["Epona", "Agro", "Ablette", "Spirit"], correct: 0 },
              { q: "O√π vit Ganon ?", options: ["Ch√¢teau de Ganon", "Temple du Temps", "Village Cocorico", "For√™t Kokiri"], correct: 0 },
            ],
            hard: [
              { q: "Quel est le nom de l'√©p√©e dans Skyward Sword ?", options: ["√âp√©e de la D√©esse", "Master Sword", "√âp√©e Kokiri", "√âp√©e Biggoron"], correct: 0 },
              { q: "Qui est Fay (Fi) ?", options: ["L'esprit de l'√©p√©e", "La s≈ìur de Link", "Une f√©e", "La reine"], correct: 0 },
              { q: "Combien de masques y a-t-il dans Majora's Mask ?", options: ["24", "20", "30", "12"], correct: 0 },
              { q: "Quel est le nom du roi d'Hyrule dans Wind Waker ?", options: ["Daphn√®s Nohansen Hyrule", "Rhoam Bosphoramus", "Zeltus", "Hylia"], correct: 0 },
              { q: "Quelle est la chronologie o√π Link perd ?", options: ["D√©clin du H√©ros", "H√©ros du Temps", "H√©ros du Vent", "Il ne perd jamais"], correct: 0 },
              { q: "Quel objet permet de voir la v√©rit√© ?", options: ["Monocle de V√©rit√©", "Loupe", "Lanterne", "Masque"], correct: 0 },
              { q: "Qui a cr√©√© la Triforce ?", options: ["Din, Nayru et Farore", "Hylia", "Zelda", "Ganon"], correct: 0 },
            ],
            hardcore: [
              { q: "Quel est le tout premier jeu Zelda dans la chronologie ?", options: ["Skyward Sword", "Minish Cap", "Ocarina of Time", "The Legend of Zelda"], correct: 0 },
              { q: "Quel est le nom de la langue parl√©e par Midna ?", options: ["Anglais invers√©/d√©form√©", "Hylien", "Japonais", "Gallic"], correct: 0 },
              { q: "Dans Zelda II, quelle est la particularit√© du gameplay ?", options: ["Vue de c√¥t√©", "FPS", "Tour par tour", "RTS"], correct: 0 },
              { q: "Quel est le nom du hibou qui parle beaucoup ?", options: ["Kaepora Gaebora", "Navi", "Tatl", "Ezlo"], correct: 0 },
              { q: "Quelle est la capacit√© maximale de rubis dans le premier Zelda ?", options: ["255", "999", "100", "500"], correct: 0 },
              { q: "Qui est le boss du Temple de l'Eau dans Ocarina of Time ?", options: ["Morpha", "Bongo Bongo", "Volvagia", "Gohma"], correct: 0 },
              { q: "Quel jeu Zelda n'a pas √©t√© fait par Nintendo ?", options: ["The Wand of Gamelon", "Link's Awakening", "Oracle of Ages", "Spirit Tracks"], correct: 0 },
            ],
          },
        },
        pokemon: {
          title: "Pok√©mon",
          theme: { primary: "#FFCB05", secondary: "#3B4CCA", bgStart: "#CC0000", bgEnd: "#8B0000", fontTitle: "'Luckiest Guy', cursive", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Quel est le Pok√©mon mascotte ?", options: ["Pikachu", "Dracaufeu", "Mewtwo", "√âvoli"], correct: 0 },
              { q: "Quel type est efficace contre le Feu ?", options: ["Eau", "Plante", "Glace", "Insecte"], correct: 0 },
              { q: "Quel objet capture les Pok√©mon ?", options: ["Pok√©ball", "Filet", "Cage", "Sac"], correct: 0 },
              { q: "Combien d'√©volutions a √âvoli (actuellement) ?", options: ["8", "3", "5", "10"], correct: 0 },
              { q: "Qui est le dresseur principal de l'anim√© ?", options: ["Sacha", "R√©gis", "Pierre", "Ondine"], correct: 0 },
              { q: "Quelle est la couleur de Dracaufeu ?", options: ["Orange", "Rouge", "Noir", "Vert"], correct: 0 },
              { q: "Que dit Pikachu ?", options: ["Pika Pika", "Bonjour", "Feu", "Rien"], correct: 0 },
            ],
            medium: [
              { q: "√Ä quel niveau Magicarpe √©volue-t-il ?", options: ["20", "15", "10", "25"], correct: 0 },
              { q: "Quel est le type de Mewtwo ?", options: ["Psy", "T√©n√®bres", "Spectre", "Combat"], correct: 0 },
              { q: "Combien y avait-il de Pok√©mon dans la 1√®re g√©n√©ration ?", options: ["151", "150", "100", "251"], correct: 0 },
              { q: "Quel badge donne Pierre ?", options: ["Badge Roche", "Badge Cascade", "Badge Foudre", "Badge √Çme"], correct: 0 },
              { q: "Quel Pok√©mon dort tout le temps ?", options: ["Ronflex", "Psykokwak", "Miaouss", "Rondoudou"], correct: 0 },
              { q: "Quelle est l'√©volution finale de Bulbizarre ?", options: ["Florizarre", "Tortank", "Dracaufeu", "Herbizarre"], correct: 0 },
              { q: "Quelle √©quipe m√©chante est dans Kanto ?", options: ["Team Rocket", "Team Magma", "Team Plasma", "Team Galaxy"], correct: 0 },
            ],
            hard: [
              { q: "Quel est le Pok√©mon num√©ro 1 du Pok√©dex National ?", options: ["Bulbizarre", "Mew", "Arceus", "Rhinocorne"], correct: 0 },
              { q: "Quel objet double les EV gagn√©s ?", options: ["Bracelet Macho", "Multi Exp", "Oeuf Chance", "Grelot Zen"], correct: 0 },
              { q: "Quel Pok√©mon n'a pas de faiblesse (avant G√©n 6) ?", options: ["T√©n√©fix/Spiritomb", "Mewtwo", "Ronflex", "Dracolosse"], correct: 0 },
              { q: "Quel type a √©t√© introduit en G√©n 2 ?", options: ["Acier et T√©n√®bres", "F√©e", "Dragon", "Glace"], correct: 0 },
              { q: "Comment √©volue Spectrum ?", options: ["√âchange", "Pierre Lune", "Niveau 36", "Bonheur"], correct: 0 },
              { q: "Quel est le talent cach√© de Grenousse ?", options: ["Prot√©en", "Torrent", "Crachin", "Intimidation"], correct: 0 },
              { q: "Qui a cr√©√© Mewtwo ?", options: ["La Team Rocket", "Le Professeur Chen", "La Team Plasma", "Arceus"], correct: 0 },
            ],
            hardcore: [
              { q: "Quel est le glitch c√©l√®bre de la 1√®re g√©n√©ration ?", options: ["MissingNo.", "Bad Egg", "Void Glitch", "Clonage"], correct: 0 },
              { q: "Quelle est la statistique de base Vitesse de Ninjask ?", options: ["160", "150", "140", "130"], correct: 0 },
              { q: "Quel Pok√©mon peut apprendre le plus d'attaques ?", options: ["Mew", "Arceus", "Queulorior", "M√©tamorph"], correct: 0 },
              { q: "Quel objet augmente la dur√©e de la pluie ?", options: ["Roche Humide", "Roche Chaude", "Roche Glace", "Roche Lisse"], correct: 0 },
              { q: "Combien de formes a Zarbi ?", options: ["28", "26", "24", "30"], correct: 0 },
              { q: "Quelle est la chance de base d'un Shiny (G√©n 6+) ?", options: ["1/4096", "1/8192", "1/1000", "1/2048"], correct: 0 },
              { q: "Quel Pok√©mon a la statistique d'Attaque la plus basse ?", options: ["Leveinard/Ptiravi", "Magicarpe", "Barpau", "Chenipan"], correct: 0 },
            ],
          },
        },
        fortnite: {
          title: "Fortnite",
          theme: { primary: "#9d4dbb", secondary: "#2fb5f6", bgStart: "#2a0a3b", bgEnd: "#000000", fontTitle: "'Luckiest Guy', cursive", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Comment s'appelle le bus volant ?", options: ["Bus de combat", "Magic Bus", "Fly Bus", "School Bus"], correct: 0 },
              { q: "Quel outil sert √† r√©colter des mat√©riaux ?", options: ["Pioche", "Hache", "Pelle", "Marteau"], correct: 0 },
              { q: "Quel est le but du jeu ?", options: ["√ätre le dernier survivant", "Tuer le plus de monde", "Construire une maison", "Trouver un tr√©sor"], correct: 0 },
              { q: "Quel mat√©riau est le plus solide ?", options: ["M√©tal", "Pierre", "Bois", "Diamant"], correct: 0 },
              { q: "Quelle est la raret√© 'L√©gendaire' ?", options: ["Or/Jaune", "Violet", "Bleu", "Vert"], correct: 0 },
              { q: "Que construit-on ?", options: ["Murs/Escaliers", "Voitures", "Armes", "Pi√®ges"], correct: 0 },
              { q: "Comment s'appelle la temp√™te ?", options: ["La Temp√™te", "Le Gaz", "Le Nuage", "La Zone"], correct: 0 },
            ],
            medium: [
              { q: "Quelle ville c√©l√®bre a √©t√© d√©truite par un m√©t√©ore ?", options: ["Tilted Towers", "Pleasant Park", "Retail Row", "Greasy Grove"], correct: 0 },
              { q: "Combien de PV donne une mini potion ?", options: ["25", "50", "10", "100"], correct: 0 },
              { q: "Quel skin est le plus 'tryhard' (clich√©) ?", options: ["Aura/Siren", "Banane", "Jonesy", "Poiscaille"], correct: 0 },
              { q: "Quelle saison a introduit le Chapitre 2 ?", options: ["Saison 11", "Saison 10", "Saison 1", "Saison 9"], correct: 0 },
              { q: "Quel v√©hicule est une boule ?", options: ["La Bulle Mobile", "Le Quad", "L'Avion", "Le Caddie"], correct: 0 },
              { q: "Qui est le personnage principal de l'histoire (souvent) ?", options: ["Jonesy", "Midas", "Le Visiteur", "Slone"], correct: 0 },
              { q: "Quel est le niveau maximum du Passe de Combat (pour tout d√©bloquer base) ?", options: ["100", "200", "50", "150"], correct: 0 },
            ],
            hard: [
              { q: "Quel est le nom de l'organisation secr√®te ?", options: ["L'Institut Onirique (IO)", "Les Sept", "Ghost", "Shadow"], correct: 0 },
              { q: "Qui est le chef des Sept ?", options: ["La Fondation", "Le Visiteur", "Le Scientifique", "L'Origine"], correct: 0 },
              { q: "Quel √©v√©nement a aspir√© toute la map ?", options: ["The End (Black Hole)", "The Device", "Galactus", "Travis Scott"], correct: 0 },
              { q: "Quelle arme a √©t√© retir√©e car trop puissante (Saison 7) ?", options: ["Lame de l'Infini", "Zapotron", "SCAR", "Pompe Chasseur"], correct: 0 },
              { q: "Quel jour la boutique change-t-elle ?", options: ["Tous les jours", "Chaque semaine", "Le mardi", "Le vendredi"], correct: 0 },
              { q: "Combien de d√©g√¢ts fait un pi√®ge √† pointes ?", options: ["150", "100", "75", "200"], correct: 0 },
              { q: "Quel skin √©tait le palier 100 de la saison 2 ?", options: ["Chevalier Noir", "Midas", "John Wick", "Omega"], correct: 0 },
            ],
            hardcore: [
              { q: "Quelle est la date de sortie du Battle Royale ?", options: ["Septembre 2017", "Juillet 2017", "Janvier 2018", "Septembre 2016"], correct: 0 },
              { q: "Combien de PV avait le m√©t√©ore (glitch) ?", options: ["5000", "1000", "Indestructible", "10000"], correct: 0 },
              { q: "Quel artiste a fait le premier concert virtuel ?", options: ["Marshmello", "Travis Scott", "Ariana Grande", "Eminem"], correct: 0 },
              { q: "Quel est le nom du cube violet ?", options: ["Kevin", "Steve", "Bob", "Darko"], correct: 0 },
              { q: "Quelle arme mythique appartenait √† Midas ?", options: ["Drum Gun", "SCAR", "Grappler", "Minigun"], correct: 0 },
              { q: "Quel √©tait le premier v√©hicule ajout√© ?", options: ["Caddie", "Voiture", "Avion", "Quad"], correct: 0 },
              { q: "Quel pro a gagn√© la World Cup Solo 2019 ?", options: ["Bugha", "Ninja", "Tfue", "Mongraal"], correct: 0 },
            ],
          },
        },
        gow: {
          title: "God of War",
          theme: { primary: "#b33939", secondary: "#2C3A47", bgStart: "#2d3436", bgEnd: "#000000", fontTitle: "'Cinzel', serif", fontMain: "'Roboto', sans-serif" },
          questions: {
            easy: [
              { q: "Qui est le personnage principal ?", options: ["Kratos", "Zeus", "Atreus", "Odin"], correct: 0 },
              { q: "Comment s'appelle le fils de Kratos ?", options: ["Atreus", "Boy", "Loki", "Thor"], correct: 0 },
              { q: "Quelle est l'arme embl√©matique nordique de Kratos ?", options: ["Hache Leviathan", "Lames du Chaos", "Marteau Mjolnir", "Lance Draupnir"], correct: 0 },
              { q: "Quel dieu Kratos a-t-il servi en Gr√®ce ?", options: ["Ares", "Zeus", "Hades", "Poseidon"], correct: 0 },
              { q: "Comment Kratos appelle-t-il souvent son fils ?", options: ["Boy", "Son", "Atreus", "Kid"], correct: 0 },
              { q: "Qui est la t√™te coup√©e qui accompagne Kratos ?", options: ["Mimir", "Baldur", "Brok", "Tyr"], correct: 0 },
              { q: "De quelle mythologie vient Kratos √† l'origine ?", options: ["Grecque", "Nordique", "√âgyptienne", "Romaine"], correct: 0 },
            ],
            medium: [
              { q: "Qui est la femme de Kratos dans les jeux nordiques ?", options: ["Faye", "Freya", "Sif", "Lysandra"], correct: 0 },
              { q: "Quel est le vrai nom d'Atreus (donn√© par les G√©ants) ?", options: ["Loki", "Fenrir", "Jormungandr", "Tyr"], correct: 0 },
              { q: "Qui sont les forgerons de la Hache Leviathan ?", options: ["Brok et Sindri", "Les Nains", "Hephaestus", "Ivaldi"], correct: 0 },
              { q: "Quel est le nom du grand serpent ?", options: ["Jormungandr", "Nidhogg", "Fafnir", "Orochi"], correct: 0 },
              { q: "Qui est l'antagoniste principal de GoW (2018) ?", options: ["Baldur", "Thor", "Odin", "Zeus"], correct: 0 },
              { q: "Quelle arme Kratos r√©cup√®re-t-il pour aller en Helheim ?", options: ["Lames du Chaos", "Hache Leviathan", "√âp√©e de l'Olympe", "Gants de Ceste"], correct: 0 },
              { q: "Qui a tu√© la famille de Kratos (par manipulation) ?", options: ["Kratos lui-m√™me", "Ares", "Zeus", "Athena"], correct: 0 },
            ],
            hard: [
              { q: "Quel est le nom de la m√®re de Kratos (Gr√®ce) ?", options: ["Callisto", "Gaia", "Lysandra", "Rhea"], correct: 0 },
              { q: "Qui est la Reine des Valkyries dans GoW (2018) ?", options: ["Sigrun", "Gunnr", "Rota", "Freya"], correct: 0 },
              { q: "Comment s'appelle l'√©cureuil sur l'arbre monde ?", options: ["Ratatoskr", "Nidhogg", "Hraezlyr", "Fafnir"], correct: 0 },
              { q: "Quel fr√®re de Kratos appara√Æt dans Ghost of Sparta ?", options: ["Deimos", "Hercules", "Atreus", "Perseus"], correct: 0 },
              { q: "Quelle magie Mimir utilise-t-il (ses yeux) ?", options: ["Bifr√∂st", "Lumi√®re d'Alfheim", "Magie Vanir", "Runes"], correct: 0 },
              { q: "Qui a arrach√© les ailes des Valkyries ?", options: ["Odin", "Thor", "Freya", "Mimir"], correct: 0 },
              { q: "Dans quel royaume le temps passe-t-il plus vite ?", options: ["Jotunheim", "Alfheim", "Helheim", "Asgard"], correct: 0 },
            ],
            hardcore: [
              { q: "En quelle ann√©e est sorti le tout premier God of War ?", options: ["2005", "2003", "2007", "2001"], correct: 0 },
              { q: "Quel est le nom du capitaine que Kratos laisse tomber dans l'hydre ?", options: ["Le Capitaine du bateau", "Jason", "Argos", "Alrik"], correct: 0 },
              { q: "Quelle est la toute premi√®re arme divine que Kratos re√ßoit ?", options: ["Lames du Chaos", "Lame d'Artemis", "Col√®re de Poseidon", "√âclair de Zeus"], correct: 0 },
              { q: "Qui a doubl√© Kratos (VO) dans les jeux grecs ?", options: ["Terrence C. Carson", "Christopher Judge", "Nolan North", "Troy Baker"], correct: 0 },
              { q: "Comment s'appelait la fille de Kratos (morte) ?", options: ["Calliope", "Pandora", "Lysandra", "Athena"], correct: 0 },
              { q: "Quel titan Kratos lib√®re-t-il dans GoW 2 ?", options: ["Prom√©th√©e", "Atlas", "Cronos", "Typhon"], correct: 0 },
              { q: "Quel est le nom du chien √† trois t√™tes (cerb√®re) que Kratos tue pour l'Or du Rhin ?", options: ["Il n'a pas de nom sp√©cifique", "Cerb√®re", "Orthros", "Garm"], correct: 0 },
            ],
          },
        },
      };

      // --- √âTAT GLOBAL ---
      let currentGameId = null;
      let currentDifficulty = "medium";
      let currentQuestions = [];
      let currentQuestionIndex = 0;
      let score = 0;
      let isAnswering = false;

      // --- DOM ---
      const root = document.documentElement;
      const selectScreen = document.getElementById("select-screen");
      const difficultyScreen = document.getElementById("difficulty-screen");
      const quizScreen = document.getElementById("quiz-screen");
      const resultScreen = document.getElementById("result-screen");

      const diffGameTitle = document.getElementById("diff-game-title");
      const gameTitle = document.getElementById("game-title");
      const questionText = document.getElementById("question-text");
      const optionsContainer = document.getElementById("options-container");
      const currentQNum = document.getElementById("current-q-num");
      const scoreDisplay = document.getElementById("score-display");
      const progressBar = document.getElementById("progress-bar");
      const feedbackMsg = document.getElementById("feedback-msg");
      const currentDifficultyBadge = document.getElementById("current-difficulty-badge");

      // --- LOGIQUE ---

      function initApp() {
        const user = getCurrentUser();
        if (!user) {
          document.getElementById('auth-screen').classList.remove('hidden');
          document.getElementById('select-screen').classList.add('hidden');
          document.getElementById('top-profile-btn').classList.add('hidden');
          return;
        }

        document.getElementById('auth-screen').classList.add('hidden');
        document.getElementById('select-screen').classList.remove('hidden');
        document.getElementById('top-profile-btn').classList.remove('hidden');
        
        // Appliquer les verrous sur les jeux
        const userLevel = getLevelFromXP(user.xp).level;
        Object.keys(GAME_UNLOCKS).forEach(gameId => {
          const card = document.getElementById(`game-${gameId}`);
          if (card) {
            const unlocked = isGameUnlocked(gameId, userLevel);
            card.classList.toggle('locked', !unlocked);
            const reqLvl = card.querySelector('.req-lvl');
            if (reqLvl) reqLvl.innerText = GAME_UNLOCKS[gameId];
          }
        });

        goHome();
      }

      function initGame(gameId) {
        const user = getCurrentUser();
        const userLevel = getLevelFromXP(user.xp).level;
        
        if (!isGameUnlocked(gameId, userLevel)) {
          alert(`Niveau ${GAME_UNLOCKS[gameId]} requis pour d√©bloquer ce jeu !`);
          return;
        }

        currentGameId = gameId;
        const game = gamesData[gameId];

        // Appliquer le th√®me
        applyTheme(game.theme);

        // Aller √† l'√©cran de difficult√©
        diffGameTitle.innerText = game.title.toUpperCase();

        // G√©rer les verrous de difficult√©
        Object.keys(DIFF_UNLOCKS).forEach(diff => {
          const btn = document.getElementById(`diff-${diff}`);
          if (btn) {
            const unlocked = isDifficultyUnlocked(diff, userLevel);
            btn.disabled = !unlocked;
            btn.classList.toggle('disabled-btn', !unlocked);
            const lockIcon = btn.querySelector('.fa-lock') || document.createElement('i');
            if (!unlocked) {
              lockIcon.className = 'fas fa-lock ml-2 text-xs opacity-50';
              if (!btn.querySelector('.fa-lock')) btn.querySelector('.text-2xl').appendChild(lockIcon);
            } else if (btn.querySelector('.fa-lock')) {
              btn.querySelector('.fa-lock').remove();
            }
          }
        });

        hideAllScreens();
        difficultyScreen.classList.remove("hidden");
        difficultyScreen.classList.add("fade-in");
      }

      function hideAllScreens() {
        [selectScreen, difficultyScreen, quizScreen, resultScreen, 
         document.getElementById('auth-screen'), 
         document.getElementById('profile-screen'), 
         document.getElementById('leaderboard-screen')].forEach(s => s.classList.add('hidden'));
      }

      function goHome() {
        hideAllScreens();
        selectScreen.classList.remove("hidden");
        selectScreen.classList.add("fade-in");
        applyTheme({
          primary: "#c8aa6e", secondary: "#0ac8b9",
          bgStart: "#091428", bgEnd: "#010a13",
          fontTitle: "'Cinzel', serif", fontMain: "'Roboto', sans-serif"
        });
      }

      function showProfile() {
        const user = getCurrentUser();
        if (!user) return;
        renderProfile(user);
        hideAllScreens();
        const profileScreen = document.getElementById('profile-screen');
        profileScreen.classList.remove('hidden');
        profileScreen.classList.add('fade-in');
        
        // Couleur de l'avatar bas√©e sur le nom d'utilisateur
        const colors = ['#c8aa6e', '#0ac8b9', '#f0e6d2', '#3c3c41', '#0070ba', '#ff4655', '#45d31c', '#9a33ff', '#ffb11f', '#00e1ff'];
        let hash = 0;
        for (let i = 0; i < user.username.length; i++) hash += user.username.charCodeAt(i);
        const color = colors[hash % colors.length];
        document.getElementById('profile-avatar').style.borderColor = color;
        document.getElementById('profile-avatar').style.color = color;
      }

      function showLeaderboard() {
        renderLeaderboard();
        hideAllScreens();
        document.getElementById('leaderboard-screen').classList.remove('hidden');
        document.getElementById('leaderboard-screen').classList.add('fade-in');
      }

      function selectDifficulty(level) {
        const user = getCurrentUser();
        const userLevel = getLevelFromXP(user.xp).level;
        if (!isDifficultyUnlocked(level, userLevel)) return;

        currentDifficulty = level;
        const game = gamesData[currentGameId];

        // Pr√©parer les questions selon la difficult√©
        currentQuestions = [...game.questions[level]];

        // UI Badge Difficult√©
        const labels = { easy: "FACILE", medium: "MOYEN", hard: "DIFFICILE", hardcore: "HARDCORE" };
        const colors = { easy: "text-green-400", medium: "text-yellow-400", hard: "text-red-400", hardcore: "text-purple-400" };
        currentDifficultyBadge.innerText = labels[level];
        currentDifficultyBadge.className = `px-2 py-1 rounded text-xs font-bold bg-gray-800 border border-gray-600 ${colors[level]}`;

        gameTitle.innerText = game.title;
        score = 0;
        currentQuestionIndex = 0;
        updateScoreUI();

        // Naviguer
        difficultyScreen.classList.add("hidden");
        quizScreen.classList.remove("hidden");
        quizScreen.classList.add("fade-in");

        loadQuestion();
      }

      function applyTheme(theme) {
        root.style.setProperty("--primary-color", theme.primary);
        root.style.setProperty("--secondary-color", theme.secondary);
        root.style.setProperty("--bg-start", theme.bgStart);
        root.style.setProperty("--bg-end", theme.bgEnd);
        root.style.setProperty("--font-title", theme.fontTitle);
        root.style.setProperty("--font-main", theme.fontMain);
      }

      function loadQuestion() {
        isAnswering = true;
        const q = currentQuestions[currentQuestionIndex];

        currentQNum.innerText = currentQuestionIndex + 1;
        // Met √† jour le total de questions affich√© (dynamique selon la banque de questions)
        currentQNum.nextElementSibling.innerText = `/${currentQuestions.length}`;

        questionText.innerText = q.q;
        progressBar.style.width = `${(currentQuestionIndex / currentQuestions.length) * 100}%`;
        feedbackMsg.style.opacity = "0";

        optionsContainer.innerHTML = "";

        // MELANGE DES OPTIONS
        // On cr√©e un tableau d'objets pour garder la trace de l'index original
        let shuffledOptions = q.options.map((opt, i) => ({ text: opt, originalIndex: i }));

        // Algorithme de m√©lange (Fisher-Yates)
        for (let i = shuffledOptions.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [shuffledOptions[i], shuffledOptions[j]] = [shuffledOptions[j], shuffledOptions[i]];
        }

        shuffledOptions.forEach((optObj, index) => {
          const btn = document.createElement("button");
          btn.className = "theme-btn p-4 text-left rounded w-full font-medium flex items-center";
          // L'index visuel (A, B, C...) suit la boucle
          btn.innerHTML = `<span class="inline-block w-6 h-6 border border-current rounded-full text-center text-xs leading-[20px] mr-3 opacity-70">${String.fromCharCode(65 + index)}</span>${
            optObj.text
          }`;

          // IMPORTANT : On stocke l'index original dans un attribut data
          btn.dataset.originalIndex = optObj.originalIndex;

          // On passe l'index original √† la fonction de v√©rification
          btn.onclick = () => checkAnswer(optObj.originalIndex, btn);
          optionsContainer.appendChild(btn);
        });
      }

      function checkAnswer(selectedIndex, btnElement) {
        if (!isAnswering) return;
        isAnswering = false;

        const q = currentQuestions[currentQuestionIndex];
        const buttons = optionsContainer.children;

        for (let btn of buttons) {
          btn.classList.add("disabled-btn");
        }

        if (selectedIndex === q.correct) {
          btnElement.classList.add("correct-answer");
          score++;
          updateScoreUI();
          feedbackMsg.innerHTML = '<span style="color:#00ff00"><i class="fas fa-check"></i> Bonne r√©ponse !</span>';
        } else {
          btnElement.classList.add("wrong-answer");

          // Trouver le bon bouton (celui dont le data-original-index correspond √† la bonne r√©ponse)
          for (let btn of buttons) {
            if (parseInt(btn.dataset.originalIndex) === q.correct) {
              btn.classList.add("correct-answer");
              break;
            }
          }

          feedbackMsg.innerHTML = '<span style="color:#ff0000"><i class="fas fa-times"></i> Rat√© !</span>';
        }

        feedbackMsg.style.opacity = "1";

        setTimeout(() => {
          nextQuestion();
        }, 1200);
      }

      function nextQuestion() {
        currentQuestionIndex++;
        if (currentQuestionIndex < currentQuestions.length) {
          loadQuestion();
        } else {
          showResults();
        }
      }

      function updateScoreUI() {
        scoreDisplay.innerText = score;
      }

      function showResults() {
        quizScreen.classList.add("hidden");
        resultScreen.classList.remove("hidden");
        resultScreen.classList.add("fade-in");

        document.getElementById("final-score").innerText = score;
        document.getElementById("final-score").nextElementSibling.innerText = `/${currentQuestions.length}`;

        const game = gamesData[currentGameId];
        const endRank = document.getElementById("end-rank");
        const endTitle = document.getElementById("end-title");
        const rankDesc = document.getElementById("rank-desc");

        const percentage = (score / currentQuestions.length);

        let rankTitle = "D√©butant";
        let rankDescText = "Continuez √† vous entra√Æner !";

        if (percentage === 1) {
          rankTitle = "L√âGENDE";
          rankDescText = "Un score parfait. Incroyable.";
        } else if (percentage >= 0.8) {
          rankTitle = "Ma√Ætre";
          rankDescText = "Excellent travail.";
        } else if (percentage >= 0.5) {
          rankTitle = "Initi√©";
          rankDescText = "Pas mal, mais peut mieux faire.";
        }

        endTitle.innerText = rankTitle.toUpperCase();
        endRank.innerText = `Difficult√© : ${currentDifficulty.toUpperCase()}`;
        rankDesc.innerText = rankDescText;

        // --- SAUVEGARDE & XP ---
        saveQuizResult(score, currentQuestions.length, currentDifficulty, currentGameId);
      }

      function saveQuizResult(score, total, difficulty, gameId) {
        const user = getCurrentUser();
        if (!user) return;

        const percentage = score / total;
        
        // Calcul XP
        let xpEarned = score * XP_PER_ANSWER[difficulty];
        let reason = `${score} bonnes r√©ponses √ó ${XP_PER_ANSWER[difficulty]} XP`;
        
        // Bonus de compl√©tion (si >= 60%)
        if (percentage >= 0.6) {
          const bonus = XP_BONUS_COMPLETION[difficulty];
          xpEarned += bonus;
          reason += ` + ${bonus} Bonus`;
        }
        
        // Bonus parfait
        if (percentage === 1) {
          xpEarned += 50;
          reason += ` + 50 Score Parfait`;
          user.perfectScoresCount = (user.perfectScoresCount || 0) + 1;
        }

        const oldLevel = getLevelFromXP(user.xp).level;
        user.xp += xpEarned;
        user.quizzesPlayed++;
        
        if (!user.playedGames.includes(gameId)) user.playedGames.push(gameId);
        if (!user.playedDiffs.includes(difficulty)) user.playedDiffs.push(difficulty);
        
        // Records
        if (!user.bestScores[gameId]) user.bestScores[gameId] = {};
        const prevBest = user.bestScores[gameId][difficulty] || 0;
        if (score > prevBest) {
          user.bestScores[gameId][difficulty] = score;
        }

        const { level: newLevel } = getLevelFromXP(user.xp);
        const levelUp = newLevel > oldLevel;
        user.level = newLevel;

        checkAndGrantBadges(user);

        // Sauvegarde
        const users = getUsers();
        const index = users.findIndex(u => u.username === user.username);
        users[index] = user;
        saveUsers(users);

        showXpNotification(xpEarned, reason, levelUp, newLevel);
      }

      function showXpNotification(xp, reason, levelUp, newLevel) {
        const notif = document.getElementById('xp-notification');
        document.getElementById('xp-amount').innerText = `+${xp} XP`;
        document.getElementById('xp-reason').innerText = reason;
        
        const levelUpEl = document.getElementById('xp-levelup');
        const unlockedEl = document.getElementById('xp-unlocked');
        
        levelUpEl.classList.toggle('hidden', !levelUp);
        if (levelUp) {
          document.getElementById('xp-newlevel').innerText = `Niveau ${newLevel} üéâ`;
          // V√©rifier si un nouveau jeu est d√©bloqu√©
          const newlyUnlocked = Object.entries(GAME_UNLOCKS).some(([gid, lvl]) => lvl === newLevel);
          unlockedEl.classList.toggle('hidden', !newlyUnlocked);
        } else {
          unlockedEl.classList.add('hidden');
        }

        notif.classList.add('show');
        setTimeout(() => notif.classList.remove('show'), 3500);
      }

      function checkAndGrantBadges(user) {
        const newBadges = [];
        const hasBadge = id => user.badges.includes(id);

        if (!hasBadge('first_quiz')) newBadges.push('first_quiz');
        
        const lastScore = user.bestScores[currentGameId][currentDifficulty];
        const lastTotal = currentQuestions.length;
        if (lastScore === lastTotal && !hasBadge('perfect_score')) newBadges.push('perfect_score');
        
        if (user.level >= 5 && !hasBadge('level_5')) newBadges.push('level_5');
        if (user.level >= 10 && !hasBadge('level_10')) newBadges.push('level_10');
        if (user.level >= 15 && !hasBadge('level_max')) newBadges.push('level_max');
        
        if (user.playedGames.length >= 6 && !hasBadge('explorer')) newBadges.push('explorer');
        if (user.playedGames.length >= 12 && !hasBadge('collector')) newBadges.push('collector');
        
        if (currentDifficulty === 'hardcore' && !hasBadge('hardcore_fan')) newBadges.push('hardcore_fan');
        if (currentDifficulty === 'hardcore' && lastScore === lastTotal && !hasBadge('hardcore_master')) newBadges.push('hardcore_master');
        
        if (user.playedDiffs.length >= 4 && !hasBadge('polyglot')) newBadges.push('polyglot');
        if (user.quizzesPlayed >= 50 && !hasBadge('fast')) newBadges.push('fast');
        if (user.perfectScoresCount >= 5 && !hasBadge('sniper')) newBadges.push('sniper');

        if (newBadges.length > 0) {
          user.badges = [...user.badges, ...newBadges];
        }
      }

      function renderProfile(user) {
        document.getElementById('profile-username').innerText = user.username;
        const { level, nextXP, progress } = getLevelFromXP(user.xp);
        document.getElementById('profile-level-badge').innerText = `Lv. ${level}`;
        document.getElementById('profile-xp-text').innerText = `${user.xp} / ${nextXP} XP`;
        document.getElementById('profile-xp-fill').style.width = `${progress}%`;
        
        document.getElementById('stats-quizzes').innerText = user.quizzesPlayed;
        const unlockedCount = Object.values(GAME_UNLOCKS).filter(lvl => level >= lvl).length;
        document.getElementById('stats-games').innerText = `${unlockedCount}/12`;

        // Avatar couleur bas√©e sur le nom
        const colors = ['#c8aa6e', '#0ac8b9', '#ff4655', '#4caf50', '#9d4dbb', '#f27200'];
        const colorIndex = user.username.length % colors.length;
        document.getElementById('profile-avatar').style.color = colors[colorIndex];
        document.getElementById('profile-avatar').style.borderColor = colors[colorIndex];

        // Badges
        const badgesGrid = document.getElementById('badges-grid');
        badgesGrid.innerHTML = BADGES.map(badge => `
          <div class="badge-card ${user.badges.includes(badge.id) ? '' : 'locked'}" title="${badge.desc}">
            <i class="fas ${badge.icon} theme-text-primary"></i>
            <div class="text-[10px] font-bold uppercase truncate">${badge.name}</div>
          </div>
        `).join('');

        // Meilleurs scores
        const scoresGrid = document.getElementById('best-scores-grid');
        const bestScores = Object.entries(user.bestScores).flatMap(([gid, diffs]) => 
          Object.entries(diffs).map(([diff, score]) => ({ gid, diff, score }))
        ).sort((a, b) => b.score - a.score).slice(0, 6);

        if (bestScores.length === 0) {
          scoresGrid.innerHTML = '<p class="text-gray-600 text-sm">Aucun record pour le moment.</p>';
        } else {
          scoresGrid.innerHTML = bestScores.map(s => `
            <div class="bg-black/40 p-3 rounded border border-gray-800 flex justify-between items-center">
              <div class="flex items-center">
                <i class="fas ${getGameIcon(s.gid)} mr-3 theme-text-primary"></i>
                <div>
                  <div class="text-sm font-bold">${gamesData[s.gid].title}</div>
                  <div class="text-[10px] text-gray-500 uppercase">${s.diff}</div>
                </div>
              </div>
              <div class="text-xl font-black">${s.score}</div>
            </div>
          `).join('');
        }
      }

      function getGameIcon(gameId) {
        const icons = { lol: 'fa-fist-raised', valorant: 'fa-crosshairs', gta: 'fa-car', minecraft: 'fa-cube', tekken: 'fa-fire', ac: 'fa-user-secret', mario: 'fa-gamepad', ratchet: 'fa-robot', zelda: 'fa-triforce', pokemon: 'fa-bolt', fortnite: 'fa-hammer', gow: 'fa-skull' };
        return icons[gameId] || 'fa-gamepad';
      }

      function renderLeaderboard() {
        const users = getUsers().sort((a, b) => b.xp - a.xp);
        const currentUser = getCurrentUser();
        const tbody = document.getElementById('leaderboard-body');
        
        let html = '';
        const top10 = users.slice(0, 10);
        
        const renderRow = (u, index) => {
          const isMe = u.username === currentUser.username;
          const rank = index + 1;
          let rankDisplay = rank;
          if (rank === 1) rankDisplay = 'ü•á';
          if (rank === 2) rankDisplay = 'ü•à';
          if (rank === 3) rankDisplay = 'ü•â';
          
          return `
            <tr class="border-b border-gray-900 ${isMe ? 'bg-primary-color/10 border-primary-color' : ''}">
              <td class="py-4 px-4 font-bold">${rankDisplay}</td>
              <td class="py-4 px-4">
                <div class="font-bold ${isMe ? 'theme-text-primary' : ''}">${u.username}</div>
              </td>
              <td class="py-4 px-4 text-center">
                <span class="bg-gray-800 px-2 py-1 rounded text-xs font-bold">Lv. ${getLevelFromXP(u.xp).level}</span>
              </td>
              <td class="py-4 px-4 text-right font-mono">${u.xp.toLocaleString()}</td>
              <td class="py-4 px-4 text-right text-gray-400">${u.quizzesPlayed}</td>
            </tr>
          `;
        };

        top10.forEach((u, i) => html += renderRow(u, i));

        // Si l'utilisateur n'est pas dans le top 10
        const myIndex = users.findIndex(u => u.username === currentUser.username);
        if (myIndex >= 10) {
          html += `<tr class="border-t-2 border-dashed border-gray-800"><td colspan="5" class="text-center py-2 text-gray-600">...</td></tr>`;
          html += renderRow(users[myIndex], myIndex);
        }

        tbody.innerHTML = html;
      }

      // Initialisation au chargement
      window.onload = initApp;

      function restartQuiz() {
        selectDifficulty(currentDifficulty);
      }

      function goHome() {
        hideAllScreens();
        selectScreen.classList.remove("hidden");
        selectScreen.classList.add("fade-in");
        applyTheme({
          primary: "#c8aa6e", secondary: "#0ac8b9",
          bgStart: "#091428", bgEnd: "#010a13",
          fontTitle: "'Cinzel', serif", fontMain: "'Roboto', sans-serif"
        });
      }
    </script>
  </body>
</html>
